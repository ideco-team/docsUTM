# Fetchmail

Начиная с версии Ideco UTM 7.8.6 данный модуль удален из Ideco UTM

### Синхронизация с удаленным почтовым сервером в Интернете с помощью Fetchmail

Для того чтобы собирать почту с удаленного почтового сервера на сервер
Ideco UTM используем сборщик почты fetchmail, настройка которого
доступна в веб-интерфейсе ***Сервер -\> Почтовый сервер -\>
Расширенные настройки почты -\> Загрузка почты с удалённых серверов
(fetchmail)***. Для каждого почтового ящика создается отдельное правило.

Предположим:

<div>

  - Адрес почтового сервера в Интернет, на котором зарегистрированы и
    хостятся ваши почтовые ящики:
    [mailserver.ru](http://mailserver.ru).
  - Почтовый ящик, зарегистрированный на этом сервере, имеет логин:
    petrov.
  - Пароль от этого ящика: petrovpasswd.
  - Почтовый домен Ideco UTM: [mydomain.ru](http://mydomain.ru).
  - Почта должна быть направлена в ящик пользователя
    <i.petrov@mydomain.ru>.

</div>

Тогда правило будет выглядеть так:

    mailserver.ru:pop3 petrov petrovpasswd i.petrov@mydomain.ru

Если нужно не удалять загруженные письма с удалённого почтового сервера,
используем ключ keep:

    mailserver.ru:pop3 petrov petrovpasswd i.petrov@mydomain.ru keep

Если нужно собирать почту с сервера по защищённому каналу, используем
ключ ssl:

    mailserver.ru:pop3 petrov petrovpasswd i.petrov@mydomain.ru ssl

После добавления всех правил и сохранения конфигурации правила начинают
действовать незамедлительно. С этого момента начнется сбор почты с
учетных записей удаленного сервера и сортировка писем по почтовым
ящикам на сервере Ideco UTM.

### Начиная с версии 7.3.0

Из запуска службы по умолчанию убраны параметры **keep, flush и
all** отменявшие их работу в пользовательских правилах.  
Теперь администратор может более гибко настраивать правило сбора почты
для каждого ящика.  
Примеры типовых конфигураций сбора почты с использованием комбинаций
этих параметров:

**keep, flush** - новые письма из удаленного ящика забираются и
помечаются как прочитанные, старые удаляются **перед** сбором
писем.  
После каждого сбора писем в удаленном ящике остаются только новые, со
времени последнего сбора, письма, если такие были, метятся
прочитанными и удаляются в начале следущего сбора **перед**
самим сбором (дублирования в ящике получателя не происходит).  
**keep** - забирает из удаленного ящика только новые письма, метит их
как прочитанные. Не удаляет письма из удаленного ящика.  
**keep, fetchall** - неверная настройка при которой письма из удаленного
ящика не удаляются но забираются снова каждый раз, письма дублируются до
бесконечности в ящике получателя.  
**nokeep** - забираются и удаляются новые письма. Если в удаленном ящике
были старые, на момент включения nokeep, то они не забираются и не
удаляются.  
**nokeep, flush** - новые письма забираются и удаляются, старые, если
были на момент включения flush, удаляются перед сбором писем. Почти
безполезное сочетание, так как после первого flush при nokeep ящик
впоследствии всегда остается пустым.  
**nokeep, fetchall** - забирает старые и новые письма из ящика и удаляет
старые, если были на момент включения fetchall (если старые письма ранее
были собраны, создаст дубли в ящике получателя). Удаленный ящик остается
пустым после каждого сбора.  
  
Умолчания:  
**nokeep**  
**nofetchall**  
**noflush**

Официальная документация по
fetchmail: <http://www.fetchmail.info/fetchmail-man.html>
