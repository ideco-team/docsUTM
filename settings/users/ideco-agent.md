---
description: >-
  Специализированная программа-агент для управления доступом пользователей в сеть Интернет. Использует протокол Wireguard.
---

# Ideco агент

{% hint style="success" %}
Название службы раздела **Ideco агент**: `ideco-agent-backend`; `ideco-agent-server`; `ideco-agent-websocket`. \
Список служб для других разделов доступен по [ссылке](../server-management/terminal.md).

Использует протокол Wireguard.
{% endhint %}

{% hint style="warning" %}
Установить программу Ideco агент можно только на ОС семейства Windows с 8 версии и новее.
{% endhint %}

Ideco агент управляет авторизацией пользователей при подключении к Ideco UTM в локальной сети и по VPN из внешних сетей.

{% hint style="info" %}
Программа должна быть установлена на рабочей станции пользователя.

Порты для подключения, если UTM за NAT:
* 80 TCP - для работы сертификатов let's encrypt;
* 14765 TCP и 3051 UDP  - для работы Ideco агента.
{% endhint %}

## Установка Ideco агент

* Перейдите в раздел **Пользователи –> Ideco-agent**, переведите опцию **Ideco агент** в положение включен, введите доменное имя в соответствующей строке и нажмите **Сохранить**. Появится кнопка **Скачать Ideco агент**:

![](../../.gitbook/assets/agent.gif)

* В личном кабинете пользователя по кнопке **Скачать Ideco VPN-клиент для Windows** или **Скачать Ideco агент** для пользователя Active Directory:

![](../../.gitbook/assets/agent12.png) ![](../../.gitbook/assets/agent13.png)

Сохраните и запустите двойным кликом файл установки программы *IdecoAgent.msi*.

Если требуется заранее установить адрес подключения, запустите файл из командной строки с ключом `utm_address=имя_домена` (перейдите в директорию с файлом `cd [путь до файла]` и вызовите файл с ключом `IdecoAgent.msi utm_address=имя_домена`);

## Настройка профиля для первого запуска

1. После установки запустите Ideco агент. Программа установит связь с сервером и предложит ввести данные. Дальнейший формат ввода логина и хоста зависит от количества доменов, в которые введен УТМ:

<details>
<summary>UTM введен в один домен:</summary>

Введите **логин** в домене, в качестве **хоста** укажите домен.

![](../../.gitbook/assets/agent14.png) ![](../../.gitbook/assets/agent15.png)

</details>

<details>
<summary>UTM введен в несколько доменов:</summary>

Введите **логин** в формате **имя_домена/имя_пользователя**, в качестве **хоста** укажите **IP УТМ**.

![](../../.gitbook/assets/agent16.png)
</details>

2. Нажмите **Сохранить**, чтобы создать новый профиль пользователя для авторизации;
3. Для авторизации выберите профиль пользователя из выпадающего списка и нажмите **Авторизоваться**.

{% hint style="info" %}
Если при настройке профиля не была активирована опция **Сохранить пароль**, то при следующем подключении по этому профилю будет запрошен ввод пароля.
{% endhint %}

{% hint style="info" %}
Если компьютер уже находится в домене, то Агент создаст для текущего пользователя SSO-профиль с включенным автоподключением. В ином случае нужно будет добавить стандартный профиль, воспользовавшись [инструкцией](#nastroika-profilya-dlya-pervogo-zapuska)
{% endhint %}

{% hint style="info" %}
Чтобы исключить взаимодействие пользователя с приложением нужно установить Агент на доменный компьютер с ключом хоста UTM. В этом случае авторизация для пользователей этого компьютера будет происходить через их SSO-профиль по-умолчанию в "бесшумном" режиме автоподключения.
{% endhint %}

## Редактирование профиля

1. Перейдите в раздел **Настройки**, кликнув по ![](../../.gitbook/assets/icon-gear2.png);
2. Выберите профиль для редактирования, нажав ![](../../.gitbook/assets/icon-edit.png), и внесите изменения в поля формы;
3. Сохраните изменения в полях формы, нажав кнопку **Сохранить**.

{% hint style="info" %}
Если пользователь подключается вне локальной сети, информация о сессии появится в разделах [Авторизованные пользователи](../monitor/authorized-users.md) и [VPN пользователи](../monitor/authorized-users.md/#vpn-polzovateli).

Если подключение из локальной сети, то Ideco агент создаст сессию веб-аутентификации. Информация о сессии будет доступна в разделе [Авторизованные пользователи](../monitor/authorized-users.md).

Ошибка с текстом **Неизвестная ошибка** возникает при попытке повторной авторизации уже авторизованного по IP пользователя.
{% endhint %}