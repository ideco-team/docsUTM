---
description: >-
  Как настроить Ideco NGFW для удаленной работы пользователей через терминальный сервер.
---

# Авторизация пользователей терминальных серверов

Терминальный сервер - это сервер, позволяющий множеству пользователей одновременно работать в удалённых сессиях с общими вычислительными ресурсами сервера.

Особенности работы для пользователей терминальных серверов:

* Для подключения пользователей необходимо установить на терминальный сервер **Ideco Client**.
* Каждый пользователь получает отдельный IP-адрес из заданной подсети.
* Для каждого пользователя можно настроить правила работы **Файрвола** и **Контент-фильтра**.
* Работает только с пользователями Microsoft Active Directory.

## Настройка авторизации пользователей

1\. Настройте интеграцию Ideco NGFW с [Microsoft Active Directory](/settings/users/active-directory/README.md) и выполните [импорт пользователей](/settings/users/active-directory/user-import.md).

2\. Скачайте [Ideco Client](/settings/users/ideco-client/README.md) на терминальный сервер. Для этого перейдите в раздел **Пользователи –> Ideco Client**, включите опцию и нажмите **Скачать** под необходимую ОС:

![](/.gitbook/assets/terminal-server6.png)

3\. [Импортируйте](/settings/services/certificates/upload-ssl-certificate-to-server.md) корневой сертификат Ideco NGFW на терминальный сервер.

4\. Создайте на терминальном сервере .json файл и добавьте запись:

```
{
"terminal_data":
  {
"type": "terminal",
"enable_device_vpn": true,
"cert_data": "C:\\jsonconfig\\123.pem",
"server": "192.168.100.2"
  }
}
```
* `cert_data` - полный путь до сертификата DeviceVPN;
* `server` - IP-адрес Ideco NGFW.

5\. Откройте командную строку от имени администратора и выполните команду:

```
IdecoClient.exe --set-json-config="C:\Program Files\Ideco\test.json"
```
* `C:\Program Files\Ideco\test.json` - абсолютный путь к .json файлу конфигурации.

После установки конфигурации терминальный сервер появится в списке учётных записей в разделе **Пользователи** -> **Учетные записи**.

6\. В Ideco NGFW перейдите в раздел **Пользователи –> Ideco Client** на вкладку **Подсети для терминальных серверов** и добавьте подсеть для выдачи IP-адресов пользователям:

![](/.gitbook/assets/terminal-server8.png)

* **Название** - укажите название подсети.
* **Устройство** - выберите терминальный сервер.
* **Подсеть** - укажите подсеть, в которой пользователям будут назначаться IP-адреса.
* **Комментарий** - необязательное поле.

{% hint style="warning" %}
Подсеть не должна пересекаться с уже имеющейся подсетью, в том числе с той, которая используется для VPN-подключений.
{% endhint %}

7\. Пользователи смогут подключаться к терминальному серверу, используя свои учетные данные Active Directory. Система автоматически назначит пользователям IP-адреса из указанной подсети, а информация об активных авторизациях появится в разделе **Мониторинг** -> **Сессии пользователей** в группе **Terminal Users**.

{% hint style="info" %}
Один компьютер может быть подключен к Ideco NGFW двумя способами:

* Через VPN.
* Через терминальный сервер.

Для каждого варианта создается отдельный пользователь с разными IP. Это позволяет настраивать правила **Файрвола** и **Контент-фильтра** для каждого способа подключения.
{% endhint %}