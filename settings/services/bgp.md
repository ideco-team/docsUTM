---
description: Настройка BGP для обмена информацией о доступности сетей.
---

# BGP

{% hint style="success" %}
Название службы раздела **BGP**: `frr`; `ideco-routing-backend`. \
Список служб для других разделов доступен по [ссылке](/settings/server-management/terminal/README.md).
{% endhint %}

BGP (Border Gateway Protocol) — это основной протокол динамической маршрутизации, который используется в интернете.

Для запуска сервиса он должен быть не только включен, но и корректно настроен: должен быть указан номер автономной системы, а также создан и включен хотя бы один BGP-сосед.

## Настройка своей автономной системы

1\. Введите номер автономной системы в строку **Номер AS** и нажмите **Сохранить**:

![](/.gitbook/assets/bgp.png)

2\. Переведите опцию раздела **BGP** в положение **включен**;

3\. Ideco NGFW заполнит поле **Router ID** автоматически.

## Настройка BGP-соседей

1\. Для добавления BGP-соседа нажмите **Добавить** в правом верхнем углу;

2\. Заполните поля:

![](/.gitbook/assets/bgp1.png)

* **Исходящий интерфейс** - интерфейс Ideco NGFW, IP-адрес которого будет использован для обмена маршрутами. Для надежности и стабильности работы службы рекомендуем выбрать [Loopback-интерфейс](/settings/services/connection-to-provider/all-ethernet.md). Если выбран **Любой**, будет использоваться ближайший к соседу интерфейс;
* **Название** - любое значение;
* **IP-адрес** - IP-адрес BGP-соседа. Рекомендуем указать адрес Loopback-интерфейса соседа;
* **Номер AS** - номер AS BGP-соседа;
* **Входящие сети** - сети, информацию от которых хотите получать. Если выбран объект **Любой**, то фильтрация будет отключена и будут приниматься все сети от BGP-соседа. Предустановленный объект фильтров **Маршрут по умолчанию** соответствует фильтру **0.0.0.0/0**;
* **Анонсируемые сети** - сети, информацию о которых хотите отправлять. Если выбран объект **Любой**, то фильтрация будет отключена и будет передаваться информация обо всех маршрутах, известных NGFW (redistribute static, connected, ospf). Предустановленный объект фильтров **Маршрут по умолчанию** соответствует фильтру **0.0.0.0/0**;
* **AS-Path Prepend** - чем больше значение, тем менее приоритетным становится канал;
* **Local Preference** - определяет приоритет пути для выхода трафика. Чем больше значение, тем более приоритетным становится канал;
* **MED** - определяет приоритет пути для входа трафика. Чем меньше значение, тем приоритетнее путь.

{% hint style="info" %}
Для динамической маршрутизации сетей двух NGFW, соединенных по IPSec, воспользуйтесь BGP. Подробнее про настройку подключения двух NGFW по IPSec - в статье [Подключение по IPsec между двумя Ideco NGFW](/settings/services/ipsec/site-to-site/ipsec-utm-to-utm-tunnel.md)

Для **Входящих сетей** и **Анонсируемых сетей** объект **Любой** не может быть установлен одновременно с другими фильтрами.
{% endhint %}

{% hint style="success" %}
На Ideco NGFW по умолчанию включен **BGP Multipath**. Этот механизм позволяет устанавливать несколько путей BGP к одному месту назначения в таблице IP-маршрутизации. BGP Multipath не влияет на процесс выбора лучшего пути. 
{% endhint %}

Если нужного объекта для фильтрации нет, то создать его можно, выбрав **Создать новый объект** в поле **Входящие сети** или **Анонсируемые сети**:

![](/.gitbook/assets/bgp2.png)

* **Название** - любое значение;
* **Значение** - значение подсети в формате: `подсеть/маска подсети`, например, `192.168.100.0/24`.
