---
description: >-
  Настройка BGP для обмена информацией о доступности сетей.
---

# BGP

{% hint style="success" %}
Название службы раздела **BGP**: `frr`; `ideco-routing-backend`. \
Список служб для других разделов доступен по [ссылке](/settings/server-management/terminal/README.md).
{% endhint %}

Border Gateway Protocol (BGP) - это основной динамический протокол прикладного уровня, используемый для маршрутизации пакетов между автономными системами (сеть или группа сетей, работающих по единой политике маршрутизации).

Для запуска сервиса BGP должен быть корректно настроен и включен минимум один BGP-сосед.

{% hint style="info" %}
На Ideco NGFW по умолчанию включен **BGP Multipath** - механизм, позволяющий устанавливать несколько путей BGP к одному месту назначения в таблице IP-маршрутизации. **BGP Multipath** не влияет на процесс выбора лучшего пути.
{% endhint %}

## Настройка автономной системы

1\. Перейдите в раздел **Сервисы -> BGP** и введите номер автономной системы в строку **Номер AS** в блоке **Настройки**:

![](/.gitbook/assets/bgp.png)

Ideco NGFW автоматически заполняет поле **Router ID** значением наибольшего IP-адреса локальной сети, указанного в разделе [Сетевые интерфейсы](connection-to-provider/README.md).

2\. Нажмите **Сохранить** и включите модуль **BGP**.

## Настройка BGP-соседей

Для добавления BGP-соседа нажмите **Добавить** и заполните поля:

![](/.gitbook/assets/bgp1.png)

<details>

<summary>Расшифровка полей</summary>

* **Исходящий интерфейс** - интерфейс Ideco NGFW, IP-адрес которого будет использован для обмена маршрутами. Для надежности и стабильности работы службы рекомендуем выбрать [Loopback-интерфейс](/settings/services/connection-to-provider/all-ethernet.md). Если выбран **Любой**, будет использоваться ближайший к соседу интерфейс.
* **Название** - любое значение.
* **IP-адрес** - IP-адрес BGP-соседа. Рекомендуем указать адрес Loopback-интерфейса соседа.
* **Номер AS** - номер автономной системы BGP-соседа.
* **Входящие сети** - сети, информацию от которых хотите получать. Если нужного объекта для фильтрации нет, то нажмите **Создать новый объект**. Если выбран объект **Любой**, то фильтрация будет отключена и будут приниматься все сети от BGP-соседа. Предустановленный объект фильтров **Маршрут по умолчанию** соответствует фильтру **0.0.0.0/0**.
* **Анонсируемые сети** - сети, информацию о которых хотите отправлять. Если нужного объекта для фильтрации нет, то нажмите **Создать новый объект**. Если выбран объект **Любой**, то фильтрация будет отключена и будет передаваться информация обо всех маршрутах, известных NGFW (redistribute static, connected, ospf). Предустановленный объект фильтров **Маршрут по умолчанию** соответствует фильтру **0.0.0.0/0**.
* **AS-Path Prepend** - чем больше значение, тем менее приоритетным становится канал.
* **Local Preference** - определяет приоритет пути для выхода трафика. Чем больше значение, тем более приоритетным становится канал.
* **MED** - определяет приоритет пути для входа трафика. Чем меньше значение, тем приоритетнее путь.

</details>

<details>

<summary>Создание нового объекта</summary>

В поле **Входящие сети** или **Анонсируемые сети** нажмите **Создать новый объект** и заполните поля:

![](/.gitbook/assets/bgp2.png)

* **Тип** - значение **Подсеть**.
* **Название** - любое значение.
* **Значение** - значение подсети в формате: `подсеть/маска подсети`, например, `192.168.100.0/24`.

</details>

{% hint style="info" %}
Для динамической маршрутизации сетей двух NGFW, соединенных по IPsec в тунельном режиме, воспользуйтесь BGP. Подробнее про настройку подключения двух NGFW по IPSec - в [статье](/settings/services/ipsec/site-to-site/ipsec-utm-to-utm-tunnel.md).

Для **Входящих сетей** и **Анонсируемых сетей** объект **Любой** не может быть установлен одновременно с другими фильтрами.
{% endhint %}

## Полезные ссылки

* [Сетевые интерфейсы](connection-to-provider/README.md)
* [Внешние и локальные интерфейсы](/settings/services/connection-to-provider/all-ethernet.md)
* [Подключение между двумя Ideco NGFW в транспортном режиме работы](/settings/services/ipsec/site-to-site/ipsec-utm-to-utm-transport.md)