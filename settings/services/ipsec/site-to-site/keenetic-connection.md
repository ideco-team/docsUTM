# Подключение Keenetic по SSTP

Если доступ из центрального офиса в сеть за Keenetic не нужен, то воспользуйтесь статьей [Подключение по SSTP Wi-Fi роутеров Keenetic](/recipes/popular-recipes/vpn/sstp-connecting-keenetic-wi-fi-routers.md) по client-to-site подключению.

<details>

<summary>Настройка Ideco NGFW</summary>

1\. Включите и настройте порт и домен для SSTP в разделе **Пользователи -> VPN-подключения**.

2\. В разделе **Пользователи -> Учетные записи** создайте специального пользователя для удаленного роутера. **Логин и пароль пользователя будут использоваться на роутере, сохраните или запишите их:**

![](/.gitbook/assets/tree1.png)

3\. Перейдите в раздел **VPN-подключения -> Доступ по VPN** и создайте правило доступа по VPN для этого пользователя:

![](/.gitbook/assets/vpn-authorization16.png)

4\. Пропишите маршруты в удаленную сеть. Например, если сеть за роутером `192.168.10.0/24`, необходимо добавить маршрут в раздел **Сервисы -> Маршрутизация -> Локальные сети**:

![](/.gitbook/assets/routing3.png)

</details>

<details>
<summary>Настройка роутера Keenetic</summary>

Настройте VPN-подключение роутера Keenetic по инструкции для client-to-site подключений.

Не забудьте выполнить все три пункта:

1\. Настроить VPN-подключение;

2\. Настроить маршруты;

3\. Настроить DNS для резолвинга локального домена (если используете Active Directory).

</details>

{% hint style="info" %}

Для проверки связи используйте утилиты ping и traceroute.

Доступ часто блокируется в Windows из-за настроек сетевых профилей.

Разрешите доступ до "не локальных" сетей во всех профилях, выполнив команду в PowerShell (запущенного с повышением прав до администратора): `Enable-NetFirewallRule -Group "@FirewallAPI.dll,-28502"`

{% endhint %}

# Подключение Keenetic по IPsec

На стороне Ideco NGFW произведите настройки подключения в разделе **Сервисы -> IPsec -> Исходящие подключения** или в разделе **Сервисы -> IPsec -> Входящие подключения**.

На стороне устройства Keenetic используйте следующие настройки протоколов шифрования:

![](/.gitbook/assets/keenetic-connection3.png)

![](/.gitbook/assets/keenetic-connection4.png)

![](/.gitbook/assets/keenetic-connection5.png)
