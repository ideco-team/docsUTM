# ГОСТ VPN

**ГОСТ VPN** - это протокол для соединения двух устройств NGFW с использованием технологии виртуальной частной сети. Соединение шифруется с применением российского сертифицированного решения от компании Рутокен. Использование **ГОСТ VPN** в Ideco NGFW не делает его сертифицированным ФСТЕК. Если вам требуется сертифицированная ФСТЕК версия межсетевого экрана, используйте Ideco UTM ФСТЭК. 

Используются алгоритмы шифрования:

* **ГОСТ Р 34.10-2012** - для создания ключевой пары;
* **ГОСТ Р 34.12-2015** (*Кузнечик* и *Магма*) - для симметричного шифрования;
* **VKO ГОСТ Р 34.10-2012** - для выработки сессионных ключей.

Туннельное соединение можно использовать в [маршрутизации](/settings/services/routing.md) локальных сетей, динамической маршрутизации [OSPF](/settings/services/ospf.md) и в [Файрволе](/settings/access-rules/firewall.md).

В разделе [График загруженности -> ГОСТ VPN](/settings/monitor/workload-schedule.md#gost-vpn) представлена информация о входящих и исходящих соединениях ГОСТ VPN, а также данные мониторинга трафика.

{% hint style="info" %}
В случае извлечения USB-токена или истечения срока действия сертификатов, хранящихся на USB-токене, VPN-соединение будет разорвано.
{% endhint %}

## Настройка ГОСТ VPN

Для настройки ГОСТ VPN необходимо подготовить USB-токен в соответствии с инструкцией, представленной в [статье](/settings/services/usb_tokens.md), и подключить его к USB-порту сервера.

Для создания соединения между двумя Ideco NGFW необходимо настроить входящее соединение на одном NGFW и исходящее соединение на другом NGFW.

### Настройка исходящего подключения

1\. Перейдите в раздел **Сервисы -> ГОСТ VPN** и нажмите **Добавить**.

2\. Заполните поля:

![](/.gitbook/assets/gost-vpn.png)

<details>

<summary>Расшифровка полей</summary>

* **Имя** - максимальное количество символов - 42;
* **Зона** - выберите зону, в которую нужно добавить подключение, или оставьте поле пустым;
* **Тип подключения** - выберите **Исходящее**;
* **Адрес удаленного устройства** - введите доменное имя другого Ideco NGFW или его белый IP-адрес;
* **Порт** - введите порт в диапазоне от 5001 до 6000;
* **IP-адрес интерфейса туннеля** - укажите IP-адрес интерфейса туннеля, который будет использоваться для маршрутизации данных на сетевом уровне;
* **Локальный сертификат** - выберите локальный сертификат настраиваемого устройства, который содержит приватный ключ и хранится на USB-токене;
* **Доверенный сертификат** - выберите доверенный сертификат, который хранится на том же USB-токене, где находится локальный сертификат.

</details>

Как подготовить сертификаты и настроить USB-токен - в [статье](/settings/services/usb_tokens.md).

### Настройка входящего подключения

1\. Перейдите в раздел **Сервисы -> ГОСТ VPN** и нажмите **Добавить**.

2\. Заполните поля:

![](/.gitbook/assets/gost-vpn1.png)

<details>
<summary>Расшифровка полей</summary>

* **Имя** - максимальное количество символов - 42;
* **Зона** - выберите зону, в которую нужно добавить подключение, или оставьте поле пустым;
* **Тип подключения** - выберите **Входящее**;
* **IP-адрес интерфейса туннеля** - укажите IP-адрес интерфейса туннеля, который будет использоваться для маршрутизации данных на сетевом уровне;
* **Порт** - введите порт в диапазоне от 5001 до 6000;
* **Локальный сертификат** - выберите локальный сертификат настраиваемого устройства, который содержит приватный ключ и хранится на USB-токене;
* **Доверенный сертификат** - выберите доверенный сертификат, который хранится на том же USB-токене, где находится локальный сертификат.

</details>

Как подготовить сертификаты и настроить USB-токен - в [статье](/settings/services/usb_tokens.md).

### Статусы подключения

После настройки в таблице **ГОСТ VPN** появится site-to-site соединение, в котором можно отслеживать статус подключения.

<table><thead><tr><th width="180" align="center">Статус подключения ГОСТ VPN</th><th>Описание</th></tr></thead><tbody><tr><td align="center"><img src="/.gitbook/assets/gost_vpn_connect.png" alt="icon-tokens-green.png" data-size="line"></td><td>ГОСТ VPN подключен и работает</td></tr><tr><td align="center"><img src="/.gitbook/assets/gost_vpn_connecting.png" alt="icon-tokens-grey.png" data-size="line"></td><td>Происходит установление соединения или ожидание ответа от другого устройства</td></tr><tr><td align="center"><img src="/.gitbook/assets/gost_vpn_disable.png" alt="icon-tokens-error.png" data-size="line"></td><td>Происходит разъединение подключенных устройств</td></tr><tr><td align="center"><img src="/.gitbook/assets/gost_vpn_not_connect.png" alt="icon-tokens-error.png" data-size="line"></td><td>Отсутствует подключение</td></tr><tr><td align="center"><img src="/.gitbook/assets/gost_vpn_error.png" alt="icon-tokens-error.png" data-size="line"></td><td>Возникла ошибка</td></tr></tbody></table>