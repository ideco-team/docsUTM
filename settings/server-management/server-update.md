---
description: Параметры автоматического обновления настраиваются в разделе Управление сервером -> Обновления.
---

# Обновления

{% hint style="success" %}
Название службы раздела **Обновления**: `ideco-sysupdate-backend`. \
Список служб для других разделов доступен по [ссылке](/settings/server-management/terminal/README.md).
{% endhint %}

{% hint style="warning" %}
Для отключения автоматического обновления Ideco NGFW в строке **Отложить обновление** выберите **Навсегда**.
{% endhint %}

## Система

Обновить систему Ideco NGFW можно как в офлайн-режиме, так и по сети. Отрегулировать режим обновления можно в разделе **Управление сервером -> Лицензия**.

В режиме **Автоматического обновления** доступны следующие настройки:

![](/.gitbook/assets/updates.png)

<details> 

<summary>Расшифровка полей</summary>

* **Канал обновлений** - пункт **Релиз** позволяет обновляться на стабильно работающие версии. Пункт **Тестовый** позволяет быстрее обновляться как на релизные версии, так и на последние бета-версии продукта во время коротких периодов бета-тестирования новых мажорных версий. По умолчанию выбран пункт **Релиз**.
* **Отложить обновления** - время, на которое будет отложено обновление (Максимальный срок - шесть месяцев с даты релиза последней версии, до которой доступно обновление).
* **День недели** - день недели запуска автоматического обновления.
* **Час автоматической перезагрузки** - час запуска автоматического обновления.
* **Загрузить файл .iso** - позволяет обновить Ideco NGFW путем загрузки ISO-образа необходимой версии.
* **Запустить обновление** - запускает механизм принудительного обновления. Если кнопка неактивна, обновления отсутствуют.

</details>

В режиме **Ручной загрузки** обновлений необходимо скачать ISO-образ новой версии Ideco NGFW в личном кабинете MY.IDECO и загрузить его с внешнего носителя:

![](/.gitbook/assets/updates1.png)

{% hint style="info" %}
Кнопка принудительного обновления активна, когда обновление уже скачано, и только применяет его, инициировать скачивание нельзя.

После принудительного обновления потребуется полная перезагрузка сервера.
{% endhint %}

После проведения процедуры обновления новая версия будет отображаться в верхнем левом углу веб-интерфейса NGFW.

Обновить серверы Ideco NGFW, подключенные к центральной консоли, можно через Ideco Center. Для этого нужно перейти в интерфейс NGFW одним из способов, указанных в разделе [Ideco Center](/settings-cc/README.md).

### Восстановление на предыдущую версию

![](/.gitbook/assets/updates2.png)

Кнопка **Восстановить** позволяет вернуться к предыдущей версии NGFW. Система будет перезагружена, при этом текущие настройки будут потеряны. После восстановления отложите автоматическое обновление.

Если в **Ideco NGFW** настроен кластер, то в веб-интерфейсе будет отсутствовать пункт **Восстановление на предыдущую версию**.

{% hint style="warning" %}
При восстановлении на предыдущую версию данные перенесены не будут. Сохраните информацию на внешнем носителе.
{% endhint %}

### Процесс выхода релизов в каналы обновлений

**Тестовый** канал обновлений позволяет быстрее обновляться до новых версий (релизных или бета-версий во время их активного тестирования). После выхода бета-версии NGFW в **Тестовый** канал ожидается обратная связь от пользователей по использованию новой версии продукта. Обратная связь позволяет выявить недочеты и уязвимости в продукте. После их исправления происходит выкладка в канал **Релиз**.

{% hint style %}
Если в версии NGFW, вышедшей в канал **Релиз**, в ходе использования выявляются недочеты, то они исправляются ближайшими обновлениями версии. Обновление в канале **Релиз** появляется постепенно.
{% endhint %}

### Особенности обновления

{% tabs %}

{% tab title="NGFW" %}

* Обновление будет автоматически установлено в указанное в настройках время после релиза новой версии.
* Обновления можно отложить на срок до шести месяцев или навсегда. Если отложить обновление на определенный срок, то период будет отсчитываться от **даты релиза** последнего доступного обновления и корректироваться в соответствии с указанным для обновления днем недели.
* Даты релизов можно посмотреть на [сайте](https://ideco.ru/changelog) или в документации в разделе [Changelog](/changelog/ideco-utm/README.md).
* Номер мажорной версии NGFW - часть номера до точки (например, 14.x), номер минорной версии - часть после точки (например, x.7).
* Автоматическое обновление Ideco NGFW до следующей мажорной версии возможно только после установки последней минорной версии, выпущенной в релиз. Например, можно обновить NGFW 17.2 до версии 17.9, а затем до версии 18.6.
* Ручное обновление Ideco NGFW до следующей мажорной версии можно выполнить с любой версии. Например, можно обновить NGFW 17.2 до версии 18.5.

{% hint style="info" %}
Если обновление было отложено на шесть месяцев, но за это время вышел новый минорный релиз, дата обновления сдвигается. Шесть месяцев теперь отсчитываются с даты выхода последнего доступного минорного релиза.
{% endhint %}

{% endtab %}

{% tab title="VCE" %}

* При обновлении корневого NGFW все включенные [VCE](/settings/server-management/vce.md) автоматически обновляются вместе с корневым NGFW.
* Если в системе есть выключенные VCE, которые созданы в младшей версии корневого NGFW и не запускались после обновления, то обновление корневого NGFW на следующую мажорную версию будет заблокировано. \
*Пример:* Если в NGFW версии 18.3 создали VCE, затем выключили его и обновили корневой NGFW до 19.0, но сам VCE на 19.0 не включали, то переход с 19.0 на 20.0 будет заблокирован. \
Включите все VCE для автоматического обновления до версии корневого NGFW.
* Если VCE не включался после обновления корневого NGFW, то:
  * VCE останется на предыдущей версии.
  * Корневой NGFW можно обновить в рамках текущей мажорной версии. \
  *Пример:* корневой NGFW можно обновить с 18.3 до 18.6, но выключенный VCE останется на 18.3.

{% endtab %}

{% tab title="Кластер" %}

* Если активная нода кластера не синхронизирована с резервной или с момента последней синхронизации прошло более 30 минут, ее обновления будут заблокированы. Произойдет переключение нод кластера. Нода с младшей версией сможет обновиться без синхронизации.
* При офлайн-обновлении кластера с синхронизацией сессий обновления баз **Предотвращения вторжений**, **Контент-фильтра** и **Антивирусов веб-трафика** не синхронизируются, каждая нода обновляется отдельно. Вторая нода обновится после того, как станет активной.

{% endtab %}

{% endtabs %}


## Базы фильтрации

На вкладке **Базы фильтрации** отображается информация о последнем обновлении баз модулей фильтрации Ideco NGFW: **Контент-фильтра**, **Предотвращения вторжений**, а также GeoIP (соответствия подсетей и стран):

![](/.gitbook/assets/selfupdate2.png)

Обновить базы фильтрации Ideco NGFW можно как в офлайн-режиме, так и по сети. Выбрать режим обновления можно в разделе **Управление сервером -> Лицензия**.

### Автоматическое обновление

В режиме **Автоматического обновления** можно выбрать источник обновления баз GeoIP:

![](/.gitbook/assets/selfupdate1.png)

1\. В поле **Источник** выберите один из вариантов:

* **Стандартная** - международная база данных для определения геолокации по IP-адресам. Используется по умолчанию.
* **Минцифры** - база данных для определения стран, разработнная Министерством цифрового развития РФ.
* **Ideco** - база данных на основе **Минцифры**, актуализированная специалистами компании "Айдеко" по запросам пользователей.

2\. Нажмите **Сохранить**.

Изменения источника вступят в силу после подгрузки выбранной базы, источник отобразится в сведениях об обновлении в строке **GeoIP**.

### Ручное обновление

Ручная загрузка необходима только в случае, если сервер не имеет доступа в интернет, а в разделе **Управление сервером -> Лицензия** выбран способ обновления **Ручная загрузка**.
Чтобы загрузить на Ideco NGFW файлы обновления баз, скачайте их в личном кабинете [MY.IDECO](https://my.ideco.ru/) одним из способов:

{% tabs %}

{% tab title="Способ 1" %}

1\. В интерфейсе Ideco NGFW на вкладке **Управление сервером -> Обновления -> Базы фильтрации** скачайте файл или перейдите по ссылке:

![](/.gitbook/assets/selfupdate.png)

2\. Скачайте и загрузите файлы:

![](/.gitbook/assets/my-ideco-ngfw.png)

{% endtab %}

{% tab title="Способ 2" %}

1\. В интерфейсе MY.IDECO напротив названия сервера нажмите ![](/.gitbook/assets/icon-download.png) и вставьте ссылку, скопированную на вкладке **Обновления -> Базы фильтрации**, в открывшуюся форму.

2\. Скачайте файлы.

{% hint style="warning" %}
При скачивании Обновления баз (Предотвращение вторжений, базы GeoIP) через **Google Chrome** необходимо, чтобы в настройках браузера был разрешен **Небезопасный контент** для [my.ideco.ru](https://my.ideco.ru/).
{% endhint %}

3\. В веб-интерфейсе Ideco NGFW перейдите на вкладку **Управление сервером -> Обновления -> Базы фильтрации** и загрузите скачанные файлы, нажав на соответствующие кнопки.

{% endtab %}

{% endtabs %}

{% hint style="danger" %}
Базы фильтрации Ideco NGFW могут меняться ежедневно, поэтому при ручной загрузке обновляйте их как можно чаще.
{% endhint %}