---
description: Создание шаблонов отчетов и настройка рассылки на электронную почту.
---

# Конструктор отчетов

В разделе **Отчеты и журналы -> Конструктор отчетов** доступно создание шаблонов отчетов со статистическими данными и настройка автоматической отправки по email в форматах PDF и/или CSV по расписанию.

![](/.gitbook/assets/report-designer4.png)

{% hint style="info" %}
Ideco NGFW хранит данные в течение определенного времени (TTL), по прошествии которого они безвозвратно удаляются и не могут быть включены в отчеты.

Сроки хранения данных по разделам:

* [Системный журнал](/settings/reports/logs.md) (кроме логов служб `strongswan`, `squid`, `ideco-app-control`, `fail2ban`) - 90 дней;
* Логи [служб](/settings/server-management/terminal/README.md) `strongswan`, `squid`, `ideco-app-control`, `fail2ban` (Системный журнал) - 14 дней;
* Данные веб-трафика (Журнал веб-трафика, а также посещенные сайты) - 1 месяц;
* События безопасности (Журнал IPS и Web application firewall) - 3 месяца;
* Действия администраторов и Авторизация администраторов - 1 год;
* Журнал аутентификации - 180 дней.
{% endhint %}

## Создание шаблона

 1\. На вкладке **Мои шаблоны** нажмите **Добавить** и заполните поля:

![](/.gitbook/assets/report-designer3.gif)

* **Период** - укажите временной промежуток, за который следует сформировать отчет, из предложенных фильтров или укажите даты, нажав **Выбрать дату**;
* **Название отчета** - укажите название отчета.

2\. Нажмите **Добавить виджет** и заполните поля:

![](/.gitbook/assets/report-designer.png)

* **По кому/чему** - выберите объект, по которому будет собираться статистика. Если выбираете **Определенный** объект (например, *Определенный пользователь* или *Определенная группа*), то появится дополнительная строка **Объекты**, где можно выбрать несколько объектов;
* **Виджет** - выберите, какую информацию хотите видеть по выбранному объекту. Один шаблон может содержать несколько виджетов. Некоторые виджеты позволяют настроить отображение данных в шаблоне отчета:
  * **Настройки отображения** - настройте, как должны отображаться данные в отчете.

3\. Для сохранения шаблона нажмите **Добавить**.

Созданный шаблон можно редактировать, просмотреть в браузере, отправить на почту или скачать в формате PDF или CSV, нажав соответствующую кнопку в столбце **Управление**.

## Настройка расписания

1\. На вкладке **Отчеты по расписанию** нажмите **Добавить** и заполните поля:

![](/.gitbook/assets/report-designer1.png)

<details>

<summary>Расшифровка полей</summary>

* **Название** - укажите название расписания;
* **Email получателя** - укажите адрес электронной почты. Можно указать несколько почтовых адресов через кнопку **Добавить получателя**;
* **Отчеты для отправки** - выберите шаблон отчета для отправки;
* **Формат отчета** - выберите вариант формата для отправки отчета;
* **Периодичность рассылки отчетов**:
  * **Раз в день** - укажите время. Если при создании настройки время отправки меньше текущего на сервере, то отправка отчетов произойдет на следующий день;
  * **Раз в неделю** - укажите день и время отправки;
  * **Раз в месяц** - укажите необходимый день месяца. Если выбрано 31 число, но в месяце меньше дней, то выбирается последнее число месяца.
* **Комментарий** - произвольный текст, поясняющий назначение расписания отправки отчетов.
Текст отображается только в Ideco NGFW и не будет отправляться в отчетах.

</details>

2\. Сохраните расписание, нажав **Добавить**.

3\. Включите расписание, нажав на ![](/.gitbook/assets/icon-on.png) (по умолчанию выключенно).

NGFW сохранит все пользовательские настройки времени отправки во всех фильтрах (раз в день, раз в неделю и раз в месяц), но шаблон отчета будет отправляться автоматически после включения расписания и только в период, выбранный пользователем.

Если в таблице большое количество правил, воспользуйтесь кнопкой **Фильтры**.

<details>
<summary>Пример настройки ежемесячного отчета</summary>

Необходимо настроить отправку отчета с информацией о заблокированных сайтах по всем пользователям. Периодичность - ежемесячно, каждое первое число месяца.

Создайте шаблон отчета, на основании которого будет собрана статистика для отправки:

1\. Нажмите **Добавить** на вкладке **Мои шаблоны**.

2\. Выберите временной период, за который следует сформировать отчет.

3\. Укажите название отчета (поле **Название отчета**).

4\. Нажмите **Добавить виджет**.

5\. Заполните поля:

* **По кому/чему** - выберите **Всем пользователям**;
* **Виджет** - выберите **Топ заблокированных сайтов**.

6\. Укажите **Настройки отображения** в виде таблицы или круговой диаграммы:

![](/.gitbook/assets/report-designer2.gif)

7\. Сохраните шаблон, нажав **Добавить**.

Создайте расписание, по которому шаблон отчета будет отправляться на электронную почту:

1\. Нажмите **Добавить** на вкладке **Отчеты по расписанию**.

2\. Заполните поля:

* **Название** - любое название, которое поможет идентифицировать правило расписания;
* **Email получателя** - электронная почта получателя отчета. Если нужно укажите дополнительные адреса, нажав **Добавить получателя**.

3\. Выберите нужный шаблон в поле **Отчеты для отправки**.

4\. Выберите формат, в котором хотите получать отчет.

5\. Укажите настройки даты/дня и времени отправки отчета получателю (раз в месяц, каждый 1-й день месяца).

6\. Сохраните расписание, нажав **Добавить**.

7\. Включите расписание.

</details>