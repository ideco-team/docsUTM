---
description: Создание шаблонов отчетов и настройка рассылки на электронную почту.
---

# Конструктор отчетов

## Мои шаблоны

На этой вкладке создаются шаблоны со статистикой, которые можно посмотреть в браузере, отправить на электронную почту и сохранить в формате PDF или CSV.

Для создания шаблона нажмите **Добавить** в левом верхнем углу. Откроется меню настройки шаблона. Задайте временной промежуток и название отчета, нажмите **Добавить виджет**:

![](/.gitbook/assets/report-designer.png)

* В строке **По кому/чему** выберите объект, по которому будет собираться статистика. Если выбираете **Определенный** объект (например, *Определенный пользователь* или *Определенная группа*), то появится дополнительная строка **Объекты**, где можно выбрать несколько объектов;
* В строке **Виджет** укажите, какую информацию хотите видеть по выбранному объекту. Один шаблон может содержать несколько виджетов;
* Задайте **Настройки отображения**.

После окончания настройки шаблона нажмите **Добавить**.

{% hint style="info" %}
Ideco NGFW хранит данные в течение определенного времени (TTL), по прошествии которого они безвозвратно удаляются и не могут быть включены в отчеты.

Сроки хранения данных по разделам:

* [Системный журнал](/settings/reports/logs.md) (кроме логов служб `strongswan`, `squid`, `ideco-app-control`, `fail2ban`) - 90 дней;
* Логи [служб](/settings/server-management/terminal/README.md) `strongswan`, `squid`, `ideco-app-control`, `fail2ban` (Системный журнал) - 14 дней;
* Данные веб-трафика (Журнал веб-трафика, а также посещенные сайты) - 1 месяц;
* События безопасности (Журнал IPS и Web application firewall) - 3 месяца;
* Действия администраторов и Авторизация администраторов - 1 год;
* Журнал аутентификации - 180 дней.
{% endhint %}

## Отчеты по расписанию

На этой вкладке создаются и редактируются настройки для отправки рассылки на электронную почту. Отчеты отправляются в формате PDF.

Для создания настройки нажмите **Отчеты по расписанию -> Добавить** в левом верхнем углу. В одной настройке можно указать несколько почтовых адресов (кнопка **Добавить получателя**) и несколько отчетов (поле **Отчеты для отправки**):

![](/.gitbook/assets/report-designer1.png)

Периодичность рассылки отчетов:
* **Раз в день** - укажите время. Если при создании настройки время отправки меньше текущего на сервере, то отправка отчетов произойдет на следующий день;
* **Раз в неделю** - укажите день и время отправки;
* **Раз в месяц** - укажите необходимый день месяца. Если выбрано 31-е число, но в месяце меньше дней, то выбирается последнее число месяца.

Текст, добавленный в поле **Комментарий**, не будет отправляться в отчетах и отображается только в Ideco NGFW.

NGFW сохранит все пользовательские настройки времени отправки во всех фильтрах (раз в день, раз в неделю и раз в месяц) после нажатия на кнопку **Комментарий**, но отправляться шаблон будет только в период, выбранный пользователем.

Отчет создается выключенным. Чтобы его включить нажмите на ![](/.gitbook/assets/icon-on.png). Если в таблице большое количество отчетов, воспользуйтесь кнопкой **Фильтры**.

<details>
<summary>Пример настройки ежемесячного отчета</summary>

Необходимо настроить отправку отчета с информацией о заблокированных сайтах по всем пользователям. Периодичность - ежемесячно, каждое первое число месяца.

Создайте шаблон отчета, на основании которого будет собрана статистика для отправки:

1\. Нажмите **Добавить** на вкладке **Мои шаблоны**.

2\. Выберите временной период, за который следует сформировать отчет, из предложенных фильтров или укажите даты нажав **Выберите дату**.

3\. Укажите название отчета (строка *Название отчета*).

4\. Кликните по кнопке **Добавить виджет**.

5\. Заполните строки:

* **По кому/чему** - выберите **Всем пользователям**;
* **Виджет** - выберите **Топ заблокированных сайтов**;

6\. Укажите **Настройки отображения** в виде таблицы или круговой диаграммы:

![](/.gitbook/assets/report-designer2.gif)

7\. Сохраните шаблон по кнопке **Добавить**.

Создайте правило, по которому шаблон отчета будет отправляться на электронную почту:

1\. Нажмите **Добавить** на вкладке **Отчеты по расписанию**.

2\. Заполните строки:

* **Название** - любое название, которое поможет идентифицировать правило расписания;
* **Email получателя** - электронная почта получателя отчета. Если нужно отправлять отчет нескольким получателям, укажите дополнительные адреса по кнопке **Добавить получателя**.

3\. Выберите нужный шаблон в поле **Отчеты для отправки**.

4\. Укажите настройки даты/дня и времени отправки отчета получателю (раз в месяц, каждый 1-й день месяца).

</details>