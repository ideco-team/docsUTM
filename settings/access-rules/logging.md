---
description: Логирование срабатывания правил Файрвола.
---

# Логирование

## Принцип работы

Весь поступающий трафик в первую очередь проходит через правила вкладки **Логирование**. Если трафик соответствует критериям таблицы **Трафик для логирования**, то на пакете ставится виртуальная метка о необходимости логирования. По умолчанию метки нет.

Далее трафик проходит через правила в [таблицах Файрвола](firewall-tables.md). Если при срабатывании правила на трафике стояла метка логирования, то в логи попадают следующие данные:

* стандартные поля логирования;
* атрибуты пакета, с которым произошло событие (протокол, порты и IP-адреса);
* название таблицы **Файрвола**;
* идентификатор правила **Файрвола**;
* действие, которое произошло.

Для просмотра логов перейдите в раздел **Отчеты и журналы -> [Системный журнал](/settings/reports/logs.md)** и настройте фильтр событий (Служба - равен - ideco-nflog). Логи могут отправляться в сторонние коллекторы через [syslog](/settings/reports/syslog.md).

{% hint style="info" %}
Включите опцию **Логировать срабатывания правил** для начала логирования.
{% endhint %}

Такая система ограничений нужна для исключения неподходящих правил **Файрвола** из логирования. Логирование срабатываний всех правил **Файрвола** требует дополнительных ресурсов на сервере и затрудняет отладку правил. Если для нормальной работы логирование не требуется, рекомендуем его отключить.

## Трафик для логирования

Создайте и включите в таблице правило для трафика. Если сработает правило **Файрвола** с трафиком, подходящим под правило логирования, то срабатывание правила **Файрвола** будет залогировано.

{% hint style="danger" %}
Если ни одно правило в таблице не задано, срабатывание правил логироваться не будет.

Правила отметки трафика могут снять отметку с помощью действия **Не логировать** для трафика, помеченного ранее действием **Логировать**.
{% endhint %}

Предоставляется возможность гибкой выборки трафика, который подлежит логированию, за счет правил таблицы **Логирование**. 

**Пример**: требуется настроить логирование всего трафика на yandex.ru, кроме трафика от пользователя Иванова Ивана:

1\. В поле **Источник** выберите _Иванова Ивана_ и переведите опцию **Инвертировать источник** в положение **Включен**.

2\. В поле **Назначение** выберите `yandex.ru`.

3\. Выберите действие **Логировать**.

4\. В поле **Дополнительно** включите правило:

![](/.gitbook/assets/firewall1.png)
