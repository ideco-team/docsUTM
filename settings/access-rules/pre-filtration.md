# Предварительная фильтрация

Вкладка **Предварительная фильтрация** позволяет заблокировать весь трафик, попадающий под условия таблицы, до просмотра таблиц **Файрвола** (например, **FORWARD** или **INPUT**). Используйте этот раздел, если требуется фильтрация пакетов на уровне TCP/IP. 

{% hint style="info" %}
При неправильно созданных правилах доступ к веб-интерфейсу может быть заблокирован (например, блокировка протокола TCP c проверкой и блокировкой флага **SYN**). Для возвращения доступа к веб-интерфейсу отключите **Пользовательский файрвол** через локальное меню сервера или включите режим **Разрешить интернет всем**.
{% endhint %}

Для создания правила выполните действия:

1\. Перейдите в раздел **Правила трафика -> Файрвол -> Предварительная фильтрация** и нажмите **Добавить**.

2\. Заполните поля правила: 

![](/.gitbook/assets/pre-filtration1.png)

* **Протокол** - укажите номер протокола из [таблицы](https://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml). Номер может быть в диапазоне от 0 до 146 включительно;
* **Источник**: 
    * **IP-адрес** - укажите IP-адрес источника;
    * **Порт** - укажите порт источника;
* **Назначение**: 
    * **IP-адрес** - укажите IP-адрес назначения;
    * **Порт** - укажите порт назначения;
* **TCP-флаги**:
    * **Флаги для проверки** - укажите флаги TCP, которые будут проверяться. В этом поле могут быть указаны флаги: **SYN**, **ACK**, **FIN**, **RST**, **URG**, **PSH**;
    * **Флаги для блокировки** - укажите флаги TCP, которые будут заблокированы. Флаг будет доступен для блокировки, только если он содержится в поле **Флаги для проверки**;
* **Дополнительно**:
    * **Размер пакета, Байт** - укажите размер пакета в байтах;
    * **Комментарий**.

3\. Нажмите **Добавить**.