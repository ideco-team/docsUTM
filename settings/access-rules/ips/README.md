---
description: Служба обнаружения и предотвращения вторжений
---

# Предотвращение вторжений

{% hint style="success" %}
Название службы раздела *Предотвращение вторжений*: `ideco-suricata-backend`; `ideco-suricata`; `ideco-suricata-event-syncer`; `ideco-suricata-event-to-syslog`. \
Список имен служб для других разделов доступен по [ссылке](/settings/server-management/terminal.md).
{% endhint %}

{% hint style="info" %}

Служба предотвращения вторжений доступна только в **Enterprise-версии Ideco NGFW** для пользователей с активной подпиской на обновления.

Правила **Предотвращения вторжений**, [Контроля приложений](/settings/security-profiles/application-control.md) и [Ограничения скорости](/settings/access-rules/shaper.md) не обрабатывают трафик между локальными сетями и сетями филиалов.

Для исключения пользователя или групп пользователей из обработки служб **Предотвращения вторжений** добавьте соответствующее правило в **Правила трафика -> Исключения из правил**.
{% endhint %}

**Служба предотвращения вторжений** (IDS/IPS, Intrusion detection system / Intrusion prevention system) предназначена для:

* [x] Обнаружения;
* [x] Журналирования;
* [x] Предотвращения атак злоумышленников на сервер, интегрированные службы и локальную сеть. 

Правила блокировки трафика включают в себя блокирование активности троянских программ, spyware, бот-сетей, клиентов p2p и **торрент-трекеров**, вирусов, сети **TOR** (используемой для обхода правил фильтрации), анонимайзеров и т. д.

Для настройки службы перейдите на вкладку **Правила трафика -> Предотвращение вторжений**. Включите или выключите службу, переведя выключатель в соответствующее положение:

![](/.gitbook/assets/ips1.gif)

Раздел состоит из четырех вкладок:

* [Правила](rules.md) - содержит список предустановленных правил;
* [Исключения из правил](exceptions-rules.md) - фиксирует в таблицу список отключенных правил службы предотвращения вторжений;
* [Настройки](settings.md) - во вкладке создаются правила для службы предотвращения вторжений.

## Примеры использования

<details>

<summary>Как исключить узел из обработки системой IDS/IPS через терминал</summary>

Можно исключить узел из обработки в веб-интерфейсе в разделе \
 **Правила трафика -> Исключения из правил**.

**Задача:** Необходимо исключить из обработки узел `192.168.154.7`.

**Решение:**

1\. В файл `/var/opt/ideco/suricata-backend/custom.rules` добавьте следующую строку: `pass ip 192.168.154.7 any <> any any (sid:1;)`.

2\. Затем в разделе **Терминал** выполните команду `systemctl restart ideco-suricata-backend.service`.

{% hint style="warning" %}
При создании нескольких ручных правил **обязательно** изменяйте ID-правила (sid:2;), иначе служба предотвращения вторжений прекратит работу из-за наличия нескольких правил с одним sid.
{% endhint %}

</details>

<details>

<summary>Технические требования</summary>

Для работы службы предотвращения вторжений требуются значительные вычислительные ресурсы. Предпочтительным являются многоядерные (4 и более ядер) процессоры. Минимальное количество оперативной памяти для использования системы: 16 Гб.

После включения системы проконтролируйте, что мощности вашего процессора достаточно для проверки трафика, следующего через шлюз. \
В разделе **Мониторинг -> Графики загруженности** выберите параметр средняя загрузка (за 1, 5 и 15 минут).

Подробнее о [Load Average](https://habr.com/ru/company/vk/blog/335326/).

</details>