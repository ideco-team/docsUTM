# Мониторинг

## Монитор трафика

<details>
<summary>Получение списка сессий</summary>

```
GET /reports/traffic/sessions?<GET-параметры, разделенные знаком &>
```

Перечень необязательных GET-параметров:
* `limit: integer` - ограничение на количество срабатываний (строк). Минимальное значение `1`;
* `offset: integer` - количество строк, которые необходимо пропустить прежде, чем начать выводить записи. Минимальное значение `0`;
* `sort: [{"field": "string", "direction": "asc | desc"}]` - список параметров сортировки. `field` - столбец, по которому производится сортировка, `direction` - направление сортировки: `asc` - по возрастанию, `desc` - по убыванию. Сортировка производится в прямом порядке следования в массиве. По умолчанию сортируется по убыванию столбец `duration`.

**Ответ на успешный запрос:**

```json5
[
    {
        "id": "string",
        "source_ip": "string",
        "src_aliases": ["string"],
        "destination_ip": "string",
        "dst_aliases": ["string"],
        "source_proto": "string",
        "destination_proto": "string",
        "application": "string",
        "duration": "integer",
        "bps_in": "integer",
        "bps_out": "integer",
        "pps_in": "integer",
        "pps_out": "integer",
        "in_iface_alias": "string",
        "out_iface_alias": "string"
    },
    ...
]
```

* `id` - уникальный идентификатор сессии, в формате ULID;
* `source_ip` - IP-адрес источника;
* `src_aliases` - список всех id алиасов, связанных с IP-адресом источника;
* `destination_ip` - IP-адрес назначения;
* `dst_aliases` - список всех id алиасов, связанных с IP-адресом назначения;
* `source_proto` - протокол источника (если TCP или UDP, также указывается порт);
* `destination_proto` - протокол назначения (если TCP или UDP, также указывается порт);
* `application` - приложение;
* `duration` -  продолжительность сессии в секундах;
* `bps_in` - входящая скорость трафика (байты в секунду);
* `bps_out` - исходящая скорость трафика (байты в секунду);
* `pps_in` - скорость обработки входящих пакетов (пакеты в секунду);
* `pps_out` - скорость обработки исходящих пакетов (пакеты в секунду);
* `in_iface_alias` - алиас сетевого интерфейса (входящий);
* `out_iface_alias` - алиас сетевого интерфейса (исходящий).

</details>

<details>
<summary>Получение списка сессий, сгруппированных по узлам локальной сети</summary>

```
GET /reports/traffic/top/sources?<GET-параметры, разделенные знаком &>
```

Перечень необязательных GET-параметров:
* `limit: integer` - ограничение на количество срабатываний (строк). Минимальное значение `1`;
* `offset: integer` - количество строк, которые необходимо пропустить прежде, чем начать выводить записи. Минимальное значение `0`;
* `sort: [{"field": "string", "direction": "asc | desc"}]` - список параметров сортировки. `field` - столбец, по которому производится сортировка, `direction` - направление сортировки: `asc` - по возрастанию, `desc` - по убыванию. Сортировка производится в прямом порядке следования в массиве. По умолчанию сортируется по убыванию столбец `sessions`.

**Ответ на успешный запрос:**

```json5
[
    {
        "source_ip": "string",
        "src_aliases": ["string"],
        "bps_in": "integer",
        "bps_out": "integer",
        "pps_in": "integer",
        "pps_out": "integer",
        "sessions": "integer"
    },
    ...
]
```

* `source_ip` - IP-адрес источника подключения;
* `src_aliases` - список всех идентификаторов алиасов, связанных с IP-адресом источника;
* `bps_in` - входящая скорость трафика (байты в секунду);
* `bps_out` - исходящая скорость трафика (байты в секунду);
* `pps_in` - скорость обработки входящих пакетов (пакеты в секунду);
* `pps_out` - скорость обработки исходящих пакетов (пакеты в секунду);
* `sessions` - количество сессий.

</details>

<details>
<summary>Получение списка сессий, сгруппированных по приложению</summary>

```
GET /reports/traffic/top/applications?<GET-параметры, разделенные знаком &>
```

Перечень необязательных GET-параметров:
* `limit: integer` - ограничение на количество срабатываний (строк). Минимальное значение `1`;
* `offset: integer` - количество строк, которые необходимо пропустить прежде, чем начать выводить записи. Минимальное значение `0`;
* `sort: [{"field": "string", "direction": "asc | desc"}]` - список параметров сортировки. `field` - столбец, по которому производится сортировка, `direction` - направление сортировки: `asc` - по возрастанию, `desc` - по убыванию. Сортировка производится в прямом порядке следования в массиве. По умолчанию сортируется по убыванию столбец `sessions`.

**Ответ на успешный запрос:**

```json5
[
    {
        "application": "string",
        "bps_in": "integer",
        "bps_out": "integer",
        "pps_in": "integer",
        "pps_out": "integer",
        "sessions": "integer"
    },
    ...
]
```

* `application` - приложение;
* `bps_in` - входящая скорость трафика (байты в секунду);
* `bps_out` - исходящая скорость трафика (байты в секунду);
* `pps_in` - скорость обработки входящих пакетов (пакеты в секунду);
* `pps_out` - скорость обработки исходящих пакетов (пакеты в секунду);
* `sessions` - количество сессий.

</details>