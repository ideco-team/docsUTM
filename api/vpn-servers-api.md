# Управление VPN

<details>
<summary>Получение статуса VPN-сервера</summary>

```
GET /vpn_servers/status
```

**Ответ на успешный запрос:**

```json5
{
    "name": "string",
    "status": "string",
    "msg": [ "string" ]
}
```

* `name` - доменное имя;
* `status` - статус домена;
* `msg` - список сообщений, объясняющий текущее состояние.

</details>

## Настройка VPN-подключения по PPTP, SSTP

<details>
<summary>Получение настроек</summary>

```
GET /vpn_servers/settings
```

**Ответ на успешный запрос:**

```json5
{
  "pptp_enabled": "boolean",
  "sstp": {
      "enabled": "boolean",
      "domain": "string",
      "port": "integer"
  },
  "network": "string",
  "zone": "string" | "null",
  "dns_suffix": "string",
  "netflow_index": "integer",
  "expired_after_seconds": "integer"
}
```

* `pptp_enabled` - если `true`, то сервер PPTP включен, `false` - выключен;
* `sstp` - настройки сервера SSTP:
  * `enabled` - если `true`, то сервер SSTP включен, `false` - выключен;
  * `domain` - доменное имя, присвоенное внешнему интерфейсу. Если домен еще не задан, то `null`;
  * `port` - порт для подключения, одно из предустановленных значений (`1443`, `2443`, `3443`, `4443`).
* `network` - сеть, из которой VPN-серверы раздают адреса. Первый адрес в этой сети - всегда адрес самого сервера;
* `zone` - зона для Lvpn0-интерфейса. Если зона не назначена, то `null`;
* `dns_suffix` - DNS-суффикс, передаваемый в Ideco Client. Если не назначен, то может быть пустой строкой;
* `netflow_index` - целое число от 0 до 65535, индекс сетевого подключения для [NetFlow](/settings/monitor/netflow.md);
* `expired_after_seconds` - количество секунд, после которого VPN сессия считается просроченной.

</details>


<details>
<summary>Изменение настроек</summary>

```
PATCH /vpn_servers/settings
```

**Json-тело запроса:**

```json5
{
  "pptp_enabled": "boolean",
  "sstp": {
      "enabled": "boolean",
      "domain": "string",
      "port": "integer"
  },
  "network": "string",
  "zone": "string" | "null",
  "dns_suffix": "string",
  "netflow_index": "integer",
  "expired_after_seconds": "integer"
}
```

* `pptp_enabled` - если `true`, то сервер PPTP включен, `false` - выключен;
* `sstp` - настройки сервера SSTP:
  * `enabled` - если `true`, то сервер SSTP включен, `false` - выключен;
  * `domain` - доменное имя, присвоенное внешнему интерфейсу. Если домен еще не задан, то `null`;
  * `port` - порт для подключения, одно из предустановленных значений (`1443`, `2443`, `3443`, `4443`).
* `network` - сеть, из которой VPN-серверы раздают адреса. Первый адрес в этой сети - всегда адрес самого сервера;
* `zone` - зона для Lvpn0-интерфейса. Если зона не назначена, то `null`;
* `dns_suffix` - DNS-суффикс, передаваемый в Ideco Client. Если не назначен, то может быть пустой строкой;
* `netflow_index` - целое число от 0 до 65535, индекс сетевого подключения для [NetFlow](/settings/monitor/netflow.md);
* `expired_after_seconds` - количество секунд, после которого VPN сессия считается просроченной.

**Ответ на успешный запрос:** 200 OK

</details>

## Скрипт для подключения пользователей по SSTP

<details>
<summary>Проверка возможности сгенерировать скрипт</summary>

```
GET /vpn_servers/powershell/status
```

**Ответ на успешный запрос:**

```json5
{
    "sstp_available": "boolean",
}
```

</details>

<details>
<summary>Создание скрипта</summary>

```
GET /vpn_servers/powershell/sstp
```

**Ответ на успешный запрос:** создается скрипт для подключения пользователей по SSTP. В ответе отображается заголовок `Content-Disposition: attachment; filename=\"Ideco_NGFW_VPN_SSTP.ps1`

</details>

## Управление правилами доступа к VPN

<details>
<summary>Получение списка правил</summary>

```
GET /vpn_servers/access_rules
```

**Ответ на успешный запрос:**

```json5
{
    "id": "integer",
    "enabled": "boolean",
    "title": "string",
    "sources": [ "string" ],
    "objects": [ "string" ],
    "vpns": [ "string" ],
    "action": "allow" | "deny",
    "two_factor": "smsaero" | "totp" | "multifactor" | "not_required",
    "comment": "string"
}
```

* `id` - идентификатор правила;
* `enabled` - статус правила: `true` - включено, `false` - выключено;
* `title` - название правила, может быть пустым, но не должно превышать 42 символов;
* `sources` - список источников подключения, не может быть пустым, допустимые типы:
  * `any` - любой источник подключения (если указан алиас `any`, то других алиасов в списке быть не должно);
  * `ip.id` - IP-адрес;
  * `ip_range.id` - диапазон IP-адресов;
  * `subnet.id` - подсеть;
  * `ip_address_list.id` - список IP-адресов;
  * `list_of_iplists.id` - список стран;
  * `domain.id` - домен.
* `objects` - список объектов, для которых будут назначены адреса, не может быть пустым. Объекты могут быть:
  * `any` - для любых объектов (если указан объект `any`, то других объектов в списке быть не должно);
  * `user.id` - для пользователей;
  * `group.id` - для групп;
  * `security_group.guid` - для групп безопасности AD.
* `vpns` - список типов VPN (протоколов подключения), не может быть пустым. Допустимые варианты:
  * `any` - любой тип подключения (если указан `any`, то других типов VPN в списке быть не должно);
  * `pptp` - подключение по PPTP;
  * `l2tp` - подключение по L2TP;
  * `sstp` - подключение по SSTP;
  * `ikev2`- подключение по IKEv2;
  * `agent-vpn-ng` - подключение по UDP (Ideco Client);
  * `agent-vpn-tls` - подключение по TLS (Ideco Client).
* `action` - действие при совпадении источника, объекта и типа VPN, не может быть пустым, допустимые варианты:
  * `allow` - разрешить;
  * `deny` - запретить.
* `two_factor` - тип требуемой двухфакторной авторизации, не может быть пустым. Должен быть `not_required`, если в поле `action` выбран `deny`. Допустимые варианты:
  * `smsaero` - аутентификация при помощи вода кода из СМС;
  * `totp` - аутентификация сканированием QR-кода или использованием токена;
  * `multifactor` - аутентификация подтверждением личности в стороннем приложении;
  * `not_required` - двухфакторная авторизация не требуется.
* `comment` - комментарий, может быть пустым, но не должен превышать 255 символов.

</details>

<details>
<summary>Добавление правил</summary>

```
POST /vpn_servers/access_rules?anchor_item_id={int}&insert_after={true|false}
```

Параметры запроса:
* `anchor_item_id` - идентификатор правила, ниже или выше которого нужно создать новое. Если отсутствует, то новое правило будет добавлено в конец таблицы;
* `insert_after` - вставка до или после. Если `True`, то вставить правило сразу после указанного в `anchor_item_id`, если `False`, то на месте указанного в `anchor_item_id`.

**Json-тело запроса:**

```json5
{
    "enabled": "boolean",
    "title": "string",
    "sources": [ "string" ],
    "objects": [ "string" ],
    "vpns": [ "string" ],
    "action": "allow" | "deny",
    "two_factor": "smsaero" | "totp" | "multifactor" | "not_required",
    "comment": "string"
}
```

* `enabled` - статус правила: `true` - включено, `false` - выключено;
* `title` - название правила, может быть пустым, но не должно превышать 42 символов;
* `sources` - список источников подключения, не может быть пустым, допустимые типы:
  * `any` - любой источник подключения (если указан алиас `any`, то других алиасов в списке быть не должно);
  * `ip.id` - IP-адрес;
  * `ip_range.id` - диапазон IP-адресов;
  * `subnet.id` - подсеть;
  * `ip_address_list.id` - список IP-адресов;
  * `list_of_iplists.id` - список стран;
  * `domain.id` - домен.
* `objects` - список объектов, для которых будут назначены адреса, не может быть пустым. Объекты могут быть следующими:
  * `any` - для любых объектов (если указан объект `any`, то других объектов в списке быть не должно);
  * `user.id` - для пользователей;
  * `group.id` - для групп;
  * `security_group.guid` - для групп безопасности AD.
* `vpns` - список типов VPN (протоколов подключения), не может быть пустым. Допустимые варианты:
  * `any` - любой тип подключения (если указан `any`, то других типов VPN в списке быть не должно);
  * `pptp` - подключение по PPTP;
  * `l2tp` - подключение по L2TP;
  * `sstp` - подключение по SSTP;
  * `ikev2`- подключение по IKEv2;
  * `agent-vpn-ng` - подключение по UDP (Ideco Client);
  * `agent-vpn-tls` - подключение по TLS (Ideco Client).
* `action` - действие при совпадении источника, объекта и типа VPN, не может быть пустым, допустимые варианты:
  * `allow` - разрешить;
  * `deny` - запретить.
* `two_factor` - тип требуемой двухфакторной авторизации, не может быть пустым. Должен быть `not_required`, если в поле `action` выбран `deny`. Допустимые варианты:
  * `smsaero` - аутентификация при помощи вода кода из СМС;
  * `totp` - аутентификация сканированием QR-кода или использованием токена;
  * `multifactor` - аутентификация подтверждением личности в стороннем приложении;
  * `not_required` - двухфакторная авторизация не требуется.
* `comment` - комментарий, может быть пустым, но не должен превышать 255 символов.

**Ответ на успешный запрос:**

```json5
{
   "id": "integer"
}
```

* `id` - идентификатор добавленного правила.

</details>

<details>
<summary>Редактирование правил</summary>

```
PATCH /vpn_servers/access_rules/<id правила>
```

**Json-тело запроса:**

```json5
{
    "enabled": "boolean",
    "title": "string",
    "sources": [ "string" ],
    "objects": [ "string" ],
    "vpns": [ "string" ],
    "action": "allow" | "deny",
    "two_factor": "smsaero" | "totp" | "multifactor" | "not_required",
    "comment": "string"
}
```

* `enabled` - статус правила: `true` - включено, `false` - выключено;
* `title` - название правила, может быть пустым, но не должно превышать 42 символов;
* `sources` - список источников подключения, не может быть пустым, допустимые типы:
  * `any` - любой источник подключения (если указан алиас `any`, то других алиасов в списке быть не должно);
  * `ip.id` - IP-адрес;
  * `ip_range.id` - диапазон IP-адресов;
  * `subnet.id` - подсеть;
  * `ip_address_list.id` - список IP-адресов;
  * `list_of_iplists.id` - список стран;
  * `domain.id` - домен.
* `objects` - список объектов, для которых будут назначены адреса, не может быть пустым. Объекты могут быть следующими:
  * `any` - для любых объектов (если указан объект `any`, то других объектов в списке быть не должно);
  * `user.id` - для пользователей;
  * `group.id` - для групп;
  * `security_group.guid` - для групп безопасности AD.
* `vpns` - список типов VPN (протоколов подключения), не может быть пустым. Допустимые варианты:
  * `any` - любой тип подключения (если указан `any`, то других типов VPN в списке быть не должно);
  * `pptp` - подключение по PPTP;
  * `l2tp` - подключение по L2TP;
  * `sstp` - подключение по SSTP;
  * `ikev2`- подключение по IKEv2;
  * `agent-vpn-ng` - подключение по UDP (Ideco Client);
  * `agent-vpn-tls` - подключение по TLS (Ideco Client).
* `action` - действие при совпадении источника, объекта и типа VPN, не может быть пустым, допустимые варианты:
  * `allow` - разрешить;
  * `deny` - запретить.
* `two_factor` - тип требуемой двухфакторной авторизации, не может быть пустым. Должен быть `not_required`, если в поле `action` выбран `deny`. Допустимые варианты:
  * `smsaero` - аутентификация при помощи вода кода из СМС;
  * `totp` - аутентификация сканированием QR-кода или использованием токена;
  * `multifactor` - аутентификация подтверждением личности в стороннем приложении;
  * `not_required` - двухфакторная авторизация не требуется.
* `comment` - комментарий, может быть пустым, но не должен превышать 255 символов.

**Ответ на успешный запрос:** 200 OK

</details>

<details>
<summary>Удаление правил</summary>

```
DELETE /vpn_servers/access_rules/<id правила>
```

**Ответ на успешный запрос:** 200 OK

</details>

<details>
<summary>Изменение порядка правил</summary>

```
PATCH /vpn_servers/access_rules/<id правила>/position
```

**Json-тело запроса:**

```json5
{
   "direction": "up" | "down"
}
```

* `direction` - направление сдвига строки с правилом в таблице:
  * `up` - правило поднимается на одну позицию вверх;
  * `down` - правило опускается на одну позицию вниз.

**Ответ на успешный запрос:** 200 OK

</details>

## Управление правилами выдачи IP-адресов

<details>
<summary>Получение списка правил</summary>

```
GET /vpn_servers/lease_rules
```

**Ответ на успешный запрос:**

```json5
{
  "id": "integer",
  "title": "string",
  "objects": [ "string" ],
  "address": "string",
  "comment": "string",
  "enabled": "boolean"
}
```

* `id` - идентификатор правила получения адресов;
* `title` - название правила, может быть пустым, но не должно превышать 42 символов;
* `objects` - список объектов, для которых будут назначены адреса, не может быть пустым. Объекты могут быть следующими:
  * `any` - для любых объектов (если указан объект `any`, то других объектов в списке быть не должно);
  * `user.id` - для пользователей;
  * `group.id` - для групп;
  * `security_group.guid` - для групп безопасности AD.
* `address` - IP-адрес, который будет назначен пользователю, или адрес сети, в которой ему будет выделен IP-адрес, если пользователь соответствует списку объектов. В строке может быть указан IP-адрес без маски или подсеть (значение не может быть пустым и не должно повторяться);
* `comment` - комментарий, может быть пустым, но не должен превышать 255 символов;
* `enabled` - статус правила: `true` - включено, `false` - выключено.

</details>

<details>
<summary>Добавление правил</summary>

```
POST /vpn_servers/lease_rules?anchor_item_id=<integer>&insert_after=<true|false>
```

Параметры запроса:
* `anchor_item_id` - идентификатор правила, ниже или выше которого нужно создать новое. Если отсутствует, то новое правило будет добавлено в конец таблицы;
* `insert_after` - - вставка до или после. Если `True`, то вставить правило сразу после указанного в `anchor_item_id`, если `False`, то на месте указанного в `anchor_item_id`.

**Json-тело запроса:**

```json5
{
  "title": "string",
  "objects": [ "string" ],
  "address": "string",
  "comment": "string",
  "enabled": "boolean"
}
```

* `title` - название правила, может быть пустым, но не должно превышать 42 символов;
* `objects` - список объектов, для которых будут назначены адреса, не может быть пустым. Объекты могут быть следующими:
  * `any` - для любых объектов (если указан объект `any`, то других объектов в списке быть не должно);
  * `user.id` - для пользователей;
  * `group.id` - для групп;
  * `security_group.guid` - для групп безопасности AD.
* `address` - IP-адрес, который будет назначен пользователю, или адрес сети, в которой ему будет выделен IP-адрес, если пользователь соответствует списку объектов. В строке может быть указан IP-адрес без маски или подсеть (значение не может быть пустым и не должно повторяться);
* `comment` - комментарий, может быть пустым, но не должен превышать 255 символов;
* `enabled` - статус правила: `true` - включено, `false` - выключено.

**Ответ на успешный запрос:**

```json5
{
   "id": "integer"
}
```

* `id` - идентификатор добавленного правила.

</details>

<details>
<summary>Редактирование правил</summary>

```
PATCH /vpn_servers/lease_rules/<id правила>
```

**Json-тело запроса:**

```json5
{
  "title": "string",
  "objects": [ "string" ],
  "address": "string",
  "comment": "string",
  "enabled": "boolean"
}
```

* `title` - название правила, может быть пустым, но не должно превышать 42 символов;
* `objects` - список объектов, для которых будут назначены адреса, не может быть пустым. Объекты могут быть следующими:
  * `any` - для любых объектов (если указан объект `any`, то других объектов в списке быть не должно);
  * `user.id` - для пользователей;
  * `group.id` - для групп;
  * `security_group.guid` - для групп безопасности AD.
* `address` - IP-адрес, который будет назначен пользователю, или адрес сети, в которой ему будет выделен IP-адрес, если пользователь соответствует списку объектов. В строке может быть указан IP-адрес без маски или подсеть (значение не может быть пустым и не должно повторяться);
* `comment` - комментарий, может быть пустым, но не должен превышать 255 символов;
* `enabled` - статус правила: `true` - включено, `false` - выключено.

**Ответ на успешный запрос:** 200 OK

</details>

<details>
<summary>Удаление правил</summary>

```
DELETE /vpn_servers/lease_rules/<id правила>
```

**Ответ на успешный запрос:** 200 OK

</details>

<details>
<summary>Изменение порядка правил</summary>

```
PATCH /vpn_servers/lease_rules/<id правила>/position
```

**Json-тело запроса:**

```json5
[
  {
   "direction": "up" | "down"
  }
]  
```

* `direction` - направление сдвига строки с правилом в таблице:
  * `up` - правило поднимается на одну позицию вверх;
  * `down` - правило опускается на одну позицию вниз.

**Ответ на успешный запрос:** 200 OK

</details>

## Работа с таблицей VPN

<details>
<summary>Получение типов VPN, используемых в таблице Доступ по VPN</summary>

```
GET /vpn_servers/vpns_in_access_rules
```

**Ответ на успешный запрос:**

```json5
{
   "pptp": "boolean",
   "l2tp": "boolean",
   "sstp": "boolean",
   "ikev2": "boolean",
   "agent-vpn-ng": "boolean",
   "agent-vpn-tls": "boolean"
}
```

Значение по ключу `boolean` указывает, используется ли этот тип в таблице VPN.

</details>

<details>
<summary>Получение типов двуфакторной авторизации, используемых в таблице Доступ по VPN</summary>

```
GET /vpn_servers/two_factor_in_access_rules
```

**Ответ на успешный запрос:**

```json5
{
   "smsaero": "boolean",
   "totp": "boolean",
   "multifactor": "boolean"
}
```

Значение по ключу `boolean` указывает, используется ли этот тип в таблице VPN.

</details>

<details>
<summary>Получение списка правил доступа к VPN для конкретного пользователя</summary>

```
GET /vpn_servers/user_access_rules/<id пользователя>
```

**Ответ на успешный запрос:**

```json5
{
  "id": "integer",
  "enabled": "boolean",
  "title": "string",
  "sources": [ "string" ],
  "objects": [ "string" ],
  "vpns": [ "string" ],
  "action": "allow" | "deny",
  "two_factor": "smsaero" | "totp" | "multifactor" | "not_required",
  "comment": "string"
}
```

 Для несуществующего пользователя или пользователя, для которого нельзя получить полный список групп, возвращается пустой список правил.

</details>

## Передача маршрутов

<details>
<summary>Получение списка правил</summary>

```
GET /vpn_servers/route_rules
```

**Ответ на успешный запрос:**

```json
[
 {
    "id": "integer",
    "title": "string",
    "objects": [ "string" ],
    "mode": "all" | "utm" | "local" |" none" | "custom",
    "networks": [ "string" ],
    "excluded_networks": [ "string" ],
    "comment": "string",
    "enabled": "boolean"
  }
...
]
```

* `id` - идентификатор правила;
* `title` - наименование правила, может быть пустым, максимум 42 символа;
* `objects` - пользователи и группы (пользователи, группы, группы безопасности AD), не может быть пустым, допустимые типы алиасов:
   - `any` - для любых объектов (если указан объект `any`, то других объектов в списке быть не должно);
   - `user.id` - для пользователей;
   - `group.id` - для групп;
   - `security_group.guid` - для групп безопасности AD.
* `mode` - режим отправки маршрутов:
    - `all` - отправлять весь трафик на Ideco NGFW (маршрут `0.0.0.0/0`);
    - `utm` - отправлять маршруты до всех локальных сетей;
    - `local` - отправлять маршруты до локальных сетей Ideco NGFW;
    - `none` - не отправлять;
    - `custom` - отправлять только указанные.
* `networks` - список подсетей, маршруты до которых передаются в режиме `custom`. Допускаются алиасы подсетей, IP-адресов, доменов;
* `excluded_networks` - исключение адресов из маршрутов. Допускаются алиасы подсетей, IP-адресов, доменов;
* `comment` - комментарий, может быть пустым, максимум 256 символов;
* `enabled` - правило включено/выключено.

</details>

<details>
<summary>Добавление правила</summary>

```
POST /vpn_servers/route_rules?anchor_item_id={int}&insert_after={true|false}
```

Параметры запроса:
* `anchor_item_id` - идентификатор правила, ниже или выше которого нужно создать новое. Если отсутствует, то новое правило будет добавлено в конец таблицы;
* `insert_after` - вставка до или после. Если `True`, то вставить правило сразу после указанного в `anchor_item_id`, если `False`, то на месте указанного в `anchor_item_id`.

**Json-тело запроса:**

```json5
  {
    "title": "string",
    "objects": [ "string" ],
    "mode": "all" | "utm" | "local" |" none" | "custom",
    "networks": [ "string" ],
    "excluded_networks": [ "string" ],
    "comment": "string",
    "enabled": "boolean"
  }
```
* `title` - наименование правила, может быть пустым, максимум 42 символа;
* `objects` - пользователи и группы (пользователи, группы, группы безопасности AD), не может быть пустым, допустимые типы алиасов:
   - `any` - для любых объектов (если указан объект `any`, то других объектов в списке быть не должно);
   - `user.id` - для пользователей;
   - `group.id` - для групп;
   - `security_group.guid` - для групп безопасности AD.
* `mode` - режим отправки маршрутов:
    - `all` - отправлять весь трафик на Ideco NGFW (маршрут `0.0.0.0/0`);
    - `utm` - отправлять маршруты до всех локальных сетей;
    - `local` - отправлять маршруты до локальных сетей Ideco NGFW;
    - `none` - не отправлять;
    - `custom` - отправлять только указанные.
* `networks` - список подсетей, маршруты до которых передаются в режиме `custom`. Допускаются алиасы подсетей, IP-адресов, доменов;
* `excluded_networks` - исключение адресов из маршрутов. Допускаются алиасы подсетей, IP-адресов, доменов;
* `comment` - комментарий, может быть пустым, максимум 256 символов;
* `enabled` - правило включено/выключено.

**Ответ на успешный запрос:**

```json5
{
   "id": "integer",
}
```
* `id` - уникальный идентификатор добавленного правила.

</details>

<details>
<summary>Изменение правила</summary>

```
PATCH /vpn_servers/route_rules/<id правила>
```
**Json-тело запроса (все или некоторые поля):**

```json5
  {
    "title": "string",
    "objects": [ "string" ],
    "mode": "all" | "utm" | "local" |" none" | "custom",
    "networks": [ "string" ],
    "excluded_networks": [ "string" ],
    "comment": "string",
    "enabled": "boolean"
  }
```

* `title` - наименование правила, может быть пустым, максимум 42 символа;
* `objects` - пользователи и группы (пользователи, группы, группы безопасности AD), не может быть пустым, допустимые типы алиасов:
   - `any` - для любых объектов (если указан объект `any`, то других объектов в списке быть не должно);
   - `user.id` - для пользователей;
   - `group.id` - для групп;
   - `security_group.guid` - для групп безопасности AD.
* `mode` - режим отправки маршрутов:
    - `all` - отправлять весь трафик на Ideco NGFW (маршрут `0.0.0.0/0`);
    - `utm` - отправлять маршруты до всех локальных сетей;
    - `local` - отправлять маршруты до локальных сетей Ideco NGFW;
    - `none` - не отправлять;
    - `custom` - отправлять только указанные.
* `networks` - список подсетей, маршруты до которых передаются в режиме `custom`. Допускаются алиасы подсетей, IP-адресов, доменов;
* `excluded_networks` - исключение адресов из маршрутов. Допускаются алиасы подсетей, IP-адресов, доменов;
* `comment` - комментарий, может быть пустым, максимум 256 символов;
* `enabled` - правило включено/выключено.

**Ответ на успешный запрос:** 200 OK

</details>

<details>
<summary>Удаление правила</summary>

```
DELETE /vpn_servers/route_rules/<id правила>
```

**Ответ на успешный запрос:** 200 OK

</details>

<details>
<summary>Перемещение правила</summary>

```
PATCH /vpn_servers/route_rules/move
```
**Json-тело запроса:**

```json5
{
  "_meta": {
    "id": "integer",
    "anchor_item_id": "integer",
    "insert_after": "boolean",
  },
}
```

* `id` - уникальный идентификатор правила;
* `anchor_item_id` - идентификатор правила, ниже или выше которого нужно создать новое. Если отсутствует, то новое правило будет добавлено в конец таблицы;
* `insert_after` - вставка до или после. Если `True`, то вставить правило сразу после указанного в `anchor_item_id`, если `False`, то на месте указанного в `anchor_item_id`.

**Ответ на успешный запрос:** 200 OK

</details>