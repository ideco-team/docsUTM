# Управление администраторами

## Управление локальными администраторами

<details>
<summary>Получение списка локальных администраторов</summary>

```
GET /web/admins/local?format_type=JSON|CSV&columns=['id','name',...]
```

* `format_type` - поддерживается `CSV` и `JSON`, по умолчанию `JSON`;
* `columns` - список столбцов, которые попадут в `CSV` отчет, по умолчанию пустой список.

**Ответ на успешный запрос:**

```json5
[
    {
        "id": "string",
        "enabled": "boolean",
        "name": "string",
        "login": "string",
        "role": "integer",
        "comment": "string",
        "password_timestamp": "integer",
    },
    ...
]
```

* `id` - идентификатор администратора;
* `enabled` - аккаунт включен/выключен (можно/нельзя под ним зайти в систему);
* `name` - имя администратора;
* `login` - логин администратора;
* `role` - идентификатор уровня доступа администратора;
* `comment` - комментарий;
* `password_timestamp` - время последнего успешного изменения пароля.

</details>

<details>
<summary>Добавление локального администратора</summary>

```
POST /web/admins/local
```

**Json-тело запроса:**

```json5
{
    "enabled": "boolean",
    "name": "string",
    "login": "string",
    "password": "string",
    "role": "integer",
    "comment": "string",
}
```

* `enabled` - аккаунт включен/выключен (можно/нельзя под ним зайти в систему);
* `name` - имя, ненулевое текстовое поле, длина от 1 до 42 символов;
* `login` - логин не должен содержать `.` (одну точку) или `..` (две точки), а также символов [\\:/~$!\s@]. Длина поля от 1 до 42 символов включительно;
* `password` - пароль, ненулевое текстовое поле, длина от 10 до 42 символов;
* `role` - идентификатор уровня доступа аккаунта (значение - целое число от 1 до 7):
    * 1 - Администратор (полный доступ к настройке);
    * 2 - Только просмотр;
    * 3 - Просмотр отчетов;
    * 4 - Создание отчетов (доступно создание шаблонов, расписание отправки и просмотр отчетов);
    * 5 - Администратор информационной безопасности (работа с событиями безопасности);
    * 6 - Администратор файрвола (создание учетный записей, работа с правилами фильтрации, управление режимами работы файрвола);
    * 7 - Администратор настройки доступов (настройки сетевого взаимодействии пользователей файрвола, субъектов доступа, информационных систем).
* `comment` - комментарий, максимальная длина - 255 символов, может быть пустым.

**Ответ на успешный запрос:**

```json5
{
    "id": "string",
}
```
</details>

<details>
<summary>Изменение настроек и пароля локального администратора</summary>

```
PATCH /web/admins/local/<id администратора>
```

**Json-тело запроса:**

Все поля необязательные

```json5
{
    "enabled": "boolean",
    "name": "string",
    "login": "string",
    "password": "string",
    "role": "integer",
    "comment": "string",
}
```

**Ответ на успешный запрос:** 200 ОК

* `enabled` - аккаунт включен/выключен (можно/нельзя под ним зайти в систему);
* `name` - имя администратора;
* `login` - логин администратора;
* `password` - пароль (если значение `null`, пароль останется прежним);
* `role` - идентификатор уровня доступа аккаунта;
* `comment` - комментарий, максимальная длина - 255 символов, **может** быть пустым.

**При смене пароля или отключении аккаунта веб-сессии удаляются.**

</details>

<details>
<summary>Удаление локального администратора</summary>

**Последнего локального администратора удалять нельзя!**

```
DELETE /web/admins/local/<id администратора>
```

**Ответ на успешный запрос:** 200 OK

</details>

## Управление сессиями

<details>
<summary>Получение списка сессий</summary>

```
GET /monitor_backend/admin_sessions
```

**Ответ на успешный запрос:** список объектов `AdminSession`

```json5
[
   {
    "id": "string",
    "login": "string",
    "name": "string",
    "competence": ["string"],
    "role_id": "string",
    "role_name": "string",
    "domain_name": "string",
    "ip": "string",
    "auth_type": "string",
    "auth_rule_id": "string",
    "admin_id": "string",
    "login_timestamp": "integer",
    }
]
```

* `id` - идентификатор сессии администратора;
* `login` - логин администратора;
* `name` - имя администратора;
* `competence` - список доступных администратору компетенций (`admin_write` - редактирование, `admin_read` - чтение, `allow_terminal` - доступ к терминалу, `reports_view` - просмотр отчетов, `reports_change` - изменение отчетов);
* `role_id` - идентификатор уровня доступа аккаунта;
* `role_name` - название уровня доступа аккаунта;
* `domain_name` - домен, в котором находится авторизованный администратор (пустое значение, если `auth_type` не равен `ad` или `ald`);
* `ip` - IP-адрес, с которого авторизовался администратор;
* `auth_type` - тип авторизации администратора (`ad`, `ald`, `local`, `radius`);
* `auth_rule_id` - идентификатор правила, по которому авторизовался администратор;
* `admin_id` - идентификатор администратора;
* `login_timestamp` - время момента успешной авторизации администратора (число в формате YYYYMMDDhhmmss).

</details>

<details>
<summary>Удаление сессии</summary>

```
DELETE /monitor_backend/admin_sessions/{admin_session_id}
```

* `admin_session_id` - идентификатор сессии авторизации администратора

**Ответ на успешный запрос:** 200 ОК

</details>