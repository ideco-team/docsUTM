# Web-почта

Почтовый веб-интерфейс в нашем продукте может работать как на локальном, так и на внешнем интерфейсе. Для его работы необходимо отметить чекбокс **Сервисы -&gt; Почтовый сервер -&gt; Доставка -&gt; Использовать web-почту** для веб-почты на локальном интерфейсе. И **Сервисы -&gt; Обратный прокси -&gt; Web-почта на внешнем интерфейсе** для работы веб-почты на внешнем интерфейсе.

На фрагменте ниже веб-интерфейс почты включен для локальных и внешних подключений:

![](../../.gitbook/assets/4982582.png)

Далее, чтобы пользователь мог подключиться из локальной сети к почтовому веб-интерфейсу на локальный адрес Ideco UTM, в его настройках должен быть отмечен чекбокс **Разрешить почту** на вкладке **Почта**.

Для возможности пользователя подключаться к интерфейсу web-почты из Интернет на внешний IP-адрес основного внешнего интерфейса Ideco UTM, в его настройках также должен быть отмечен чекбокс **Доступ к почте из Интернет** на вкладке **Почта**.

{% hint style="info" %}
Подключиться к веб-интерфейсу почты из локальной сети можно только на первый IP-адрес основного локального интерфейса. К внешнему веб-интерфейсу почты можно подключаться по первому IP-адресу основного внешнего интерфейса или по доменному имени, ассоциированному с этим IP-адресом.
{% endhint %}

Когда все настройки произведены, из локальной сети в браузере наберите [https://192.168.0.1/mail](https://192.168.0.1/mail), где 192.168.0.1 - адрес локального интерфейса; из сети Интернет наберите в браузере [https://66.77.88.99/mail](https://66.77.88.99/mail), где 66.77.88.99 - адрес внешнего интерфейса. Для подключения обязательно использовать HTTPS.

* В открывшейся в вашем браузере форме входа в почтовый ящик в качестве логина укажите логин от учётной записи пользователя

  или полностью название почтового ящика, если тот прописан в поле **Почтовый ящик пользователя** на вкладке **Почта** у настраиваемого пользователя.

* В качестве пароля всегда прописывается пароль от учётной записи пользователя, сделать отдельный пароль на почту нельзя.

![](../../.gitbook/assets/4982585.png)

При успешном входе в браузере будет открыт веб-интерфейс к почтовому ящику пользователя.

Веб-интерфейс встроенного почтового клиента работает с почтовым сервером по протоколу IMAP и обладает следующими возможностями:

* Создавать и отправлять письма. Поддерживается загрузка множественных вложений.
* Просматривать, удалять, перемещать письма. Управлять IMAP-папками ящика.
* Глобальная и персональная \(для конкретного ящика\) адресные книги,

  работающие только в рамках веб-приложения.

* Адресная книга поддерживает формат контактов VCARD и может быть экспортирована и сохранена на вашем компьютере в этом формате.
* Календарь с возможностью создавать события и уведомлять о них сотрудников по почте.
* Цветные метки писем, как это принято в почтовом клиенте Thunderbird.

  Проставляются клавишами от 1 до 5. Изменения сохраняются на сервере так, что в другом почтовом клиенте метки будут видны.

* Гибкий расширенный поиск по всем письмам ящика. Находится в разделе **Еще...** панели инструментов ящика.

## Смена логотипа и текста приветствия на странице входа

Чтобы заменить надпись и логотип на странице входа в web-почту, нужно подменить системные файлы на диске и изменить их.  
Сделать это можно, войдя на UTM по ssh от root, включив на UTM [режим удаленного помощника](../../server-administration/remote-assistant.md) и выполнив команды, приведенные ниже.

Скопируйте конфигурационный файл на диск с изменяемыми данными:

```text
cp /usr/share/www/mail/config/config.inc.php /mnt/rw_disc/
```

Временно разрешите запись на диск с системными данными и измените файл **ics\_tune.sh**, как показано ниже.

```text
mount -o rw,remount /
nano /usr/local/ics/bin/ics_tune.sh
```

Внесите в файл следующее содержимое. Оно сообщает системе о том, что файл логотипа и конфигурации нужно подменить копиями с раздела с изменяемыми данными.

```text
#!/bin/bash

if [ "$1" = "networkd" ]; then
    mount --bind /mnt/rw_disc/config.inc.php /usr/share/www/mail/config/config.inc.php
    mount --bind /mnt/rw_disc/logo.png /usr/share/www/mail/skins/classic/images/ideco-logo.png
    mount --bind /mnt/rw_disc/logo.png /usr/share/www/mail/skins/larry/images/ideco-logo.png
fi
```

Убедитесь, что в конце файла присутствует пустая строка. Нажмите **Ctrl+x** для выхода и _**y**_ для подтверждения записи данных в файл.

Находясь в консоли, верните режим работы системного раздела _только для чтения_.

```text
mount -o ro,remount /
```

В конфигурации web-почты \(_**/mnt/rw\_disc/config.inc.php**_\) поменяйте параметр _**$config\['product\_name'\] = 'Ideco Webmail';**_ , указав в нем ваш текст.

Ваш логотип поместите в файл _**/mnt/rw\_disc/logo.png**_.

После проделанных действий выполните перезагрузку UTM.

