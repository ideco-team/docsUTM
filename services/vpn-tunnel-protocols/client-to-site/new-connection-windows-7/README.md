# Инструкция по запуску PowerShell-скриптов

Используйте загруженные с вашего сервера готовые скрипты для создания VPN-подключения в Windows версий 8.1 и 10.  
Если вы используете Windows 7, необходимо создать подключение [вручную](running-powershell-scripts.md).

## Какой протокол VPN выбрать?

При нескольких вариантах возможных подключений по VPN выбирайте протоколы по следующим приоритетам \(лучшие - первые\):

1. **IKEv2/IPSec** - лучший в плане производительности и надежности подключения протокол.
2. **SSTP** - протокол основанный на TCP и SSL. Выберите его, если подключение по IKEv2 не проходит через вашего провайдера.
3. **L2TP/IPSec** - надежный в плане шифрования, но не самый оптимальный в плане скорости и производительности протокол.
4. **PPTP** - устаревший протокол, используйте его только в случае крайней необходимости и не работоспособности других протоколов на вашей ОС.

## Как запустить PowerShell скрипт?

{% embed url="https://www.youtube.com/watch?v=Ry8OZh9mMpY" %}

1. Сохраните скрипт, кликнув по ссылке на него в личном кабинете.  

![](../../../../.gitbook/assets/17072162.png)

2. Щелкните правой кнопкой мыши по скаченному файлу и в контекстном меню выберите **Свойства**.  

![](../../../../.gitbook/assets/17072164.png)

3. Поставьте галочку **Разблокировать** справа в нижнем углу свойств файла \(по умолчанию ОС блокирует выполнение скачанных из интернета файлов\).  

![](../../../../.gitbook/assets/17072165.png)

4. Снова нажмите правой кнопкой мыши на файл и выберите **Выполнить в PowerShell** в контекстном меню.

![](../../../../.gitbook/assets/17072166.png)

При ошибке "выполнение сценариев отключено в этой системе", нужно включить выполнение сценариев, выполнив команду в PowerShell \(вызовите его через меню **Пуск**\):

```text
Set-ExecutionPolicy Unrestricted
```

5. Ответьте **Да** на вопрос о внесении изменений в ваш компьютер.  
6. Подключение создано. Нажмите **Подключиться** в списке ваших сетей.

![](../../../../.gitbook/assets/подключение%20%281%29%20%281%29%20%281%29%20%281%29%20%282%29%20%281%29.png)

## Что делать, если запустить скрипт не получается?

Возможно вам не хватает прав на запуск скриптов или PowerShell не установлен в системе.

Воспользуйтесь инструкцией для создания подключения в Windows 8-ой и 10-ой версии в [данной статье](../ipsec-ikev2/).

