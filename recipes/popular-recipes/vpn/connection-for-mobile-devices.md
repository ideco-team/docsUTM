---
description: >-
  В статье описана настройка VPN-подключения на мобильных устройствах по протоколам IKEv2/IPsec, L2TP/IPsec и PPTP.
---

# Инструкция по созданию VPN-подключения на мобильных устройствах

Перед настройкой VPN-подключения перейдите в раздел **Пользователи -> VPN-подключения -> Доступ по VPN** и создайте разрешающее VPN-подключение правило.

{% hint style="info" %}

Применение сертификатов в протоколе IKEv2/IPsec:

* Если сертификат для VPN-подключений издан NGFW, установите корневой сертификат NGFW на устройство пользователя.
* Если для VPN-подключения используется сертификат, выданный Let\`s Encrypt, то установка корневого сертификата на устройство не требуется.
* Если используется сторонний сертификат (например, от коммерческих Certificate Authority), убедитесь, что домен указан в поле Subject Alternative Name (SAN). Загрузите сертификат как пользовательский в разделе Сервисы -> Сертификаты -> Загруженные сертификаты.

Скачать сертификат можно в разделе **Сервисы -> Сертификаты -> Загруженные сертификаты** в веб-интерфейсе NGFW или в личном кабинете пользователя по кнопке **Скачать корневой сертификат**.
{% endhint %}

{% hint style="warning" %}
Не рекомендуем использовать для VPN-подключений кириллические логины.
{% endhint %}

{% tabs %}

{% tab title="Android" %}

1\. Перейдите в **VPN** в раздел **Настройки -> Подключения -> Другие настройки**. При необходимости воспользуйтесь строкой поиска по настройкам.

2\. Выберите тип подключения и заполните поля:

**Для IKEv2/IPsec MSCHAPv2:**

![](/.gitbook/assets/connection-for-mobile-devices5.png)

<details>

<summary>Расшифровка полей</summary>

* **Название сети** - имя подключения;
* **Адрес сервера** - домен или IP-адрес, указанный в Ideco NGFW в разделе **Пользователи -> VPN-подключения -> Основное -> Подключение по IKEv2/IPsec**;
* **Идентификатор IPsec** - логин пользователя, которому разрешено подключение по VPN;
* **Сертификат ЦС IPsec** - не проверять сервер;
* **Сертификат сервера** - принято от сервера;
* **Имя** - логин пользователя, которому разрешено подключение по VPN;
* **Пароль** - пароль пользователя.

</details>

**Для PPTP:**

{% hint style="info" %}
Начиная с версии Android 12 прекращена поддержка протокола PPTP. Для подключения по этим протоколам необходимо использовать сторонние приложения.
{% endhint %}

![](/.gitbook/assets/connection-for-mobile-devices4.png)

<details>

<summary>Расшифровка полей</summary>

* **Имя** - имя подключения;
* **Адрес сервера** - домен или IP-адрес Ideco NGFW;
* **Имя пользователя** - логин пользователя, которому разрешено подключение по VPN;
* **Пароль** - пароль пользователя.
  
</details>

**Для L2TP/IPsec PSK:**

{% hint style="info" %}
Начиная с версии Android 12 прекращена поддержка протокола L2TP. Для подключения по этим протоколам необходимо использовать сторонние приложения.
{% endhint %}

![](/.gitbook/assets/connection-for-mobile-devices6.png)

<details>

<summary>Расшифровка полей</summary>

* **Имя** - имя подключения;
* **Адрес сервера** - домен или IP-адрес Ideco NGFW;
* **Общий ключ IPsec** - значение строки **PSK** в разделе **Пользователи -> VPN-подключения -> Основное -> Подключение по L2TP/IPsec**.

</details>

3\. Нажмите **Сохранить** и активируйте подключение.

{% endtab %}

{% tab title="iOS" %}

1\. Перейдите в раздел **Настройки -> Основные -> VPN и управление устройством -> VPN**:

![](/.gitbook/assets/connection-for-mobile-devices7.png)

2\. Нажмите **Добавить конфигурацию VPN**:

![](/.gitbook/assets/connection-for-mobile-devices8.png)

3\. Выберите **Тип** подключения и заполните поля:

**Для PPTP:**

{% hint style="info" %}
Начиная с версии iOS-10 компания Apple убрала поддержку протокола PPTP.
{% endhint %}

![](/.gitbook/assets/connection-for-mobile-devices9.png)

<details>

<summary>Расшифровка полей</summary>

* **Описание** - название соединения;
* **Сервер** - домен или IP-адрес Ideco NGFW;
* **Учетная запись** - логин пользователя, которому разрешено подключение по VPN;
* **Пароль** - пароль пользователя.

</details>

**Для L2TP:**

![](/.gitbook/assets/connection-for-mobile-devices10.png)

<details>

<summary>Расшифровка полей</summary>

* **Описание** - название соединения;
* **Сервер** - домен или IP-адрес Ideco NGFW;
* **Учетная запись** - логин пользователя, которому разрешено подключение по VPN;
* **Пароль** - пароль пользователя;
* **Общий ключ** - значение строки **PSK** в разделе **Пользователи -> VPN-подключения -> Основное -> Подключение по L2TP/IPsec**.

</details>

**Для IKEv2:**

![](/.gitbook/assets/connection-for-mobile-devices11.png)

<details>

<summary>Расшифровка полей</summary>

* **Описание** - название соединения;
* **Сервер** - домен или IP-адрес, указанный в Ideco NGFW в разделе **Пользователи -> VPN-подключения -> Основное -> Подключение по IKEv2/IPsec**;
* **Удаленный ID** - домен или IP-адрес, указанный в Ideco NGFW в разделе **Пользователи -> VPN-подключения -> Основное -> Подключение по IKEv2/IPsec**;
* **Имя пользователя** - логин пользователя, которому разрешено подключение по VPN;
* **Пароль** - пароль пользователя.

</details>

4\. Нажмите **Готово**.

5\. Включите опцию **Статус**:

![](/.gitbook/assets/connection-for-mobile-devices12.png)

{% endtab %}

{% tab title="StrongSwan (Android)" %}


{% hint style="info" %}
Приложение StrongSwan позволяет создавать VPN-подключение только через протокол IKEv2.
{% endhint %}

1\. Нажмите **Добавить VPN профиль**:

![](/.gitbook/assets/connection-for-mobile-devices1.png)

2\. Заполните поля:

![](/.gitbook/assets/connection-for-mobile-devices2.png)

<details>

<summary>Расшифровка полей</summary>

* **Сервер** - домен или IP-адрес, указанный в Ideco NGFW в разделе **Пользователи -> VPN-подключения -> Основное -> Подключение по IKEv2/IPsec**;
* **VPN тип** - IKEv2 EAP (Логин/Пароль);
* **Логин** - логин пользователя, которому разрешено подключение по VPN;
* **Пароль** - пароль пользователя.

</details>

3\. Нажмите **Сохранить** и перейдите по созданному подключению:

![](/.gitbook/assets/connection-for-mobile-devices3.png)

{% endtab %}

{% tab title="Brooog IKEv2 (iOS)" %}

1\. Нажмите **Add VPN Connection**:

![](/.gitbook/assets/vpn-autorization21.png)

2\. Заполните поля и включите опцию **Connect on Demand**:

![](/.gitbook/assets/vpn-authorization22.png)

<details>

<summary>Расшифровка полей</summary>

* **Server** - домен или IP-адрес, указанный в Ideco NGFW в разделе **Пользователи -> VPN-подключения -> Основное -> Подключение по IKEv2/IPsec**;
* **Username** - логин пользователя, которому разрешено подключение по VPN;
* **Password** - пароль пользователя.

</details>

3\. Нажмите **Save** и переведите опцию в режим **CONNECTED**:

![](/.gitbook/assets/vpn-autorization23.png)

{% endtab %}

{% endtabs %}